function loadTeamLinks(t){$.each(t,function(t,e){$("#bottomTeamLinks").append('<a href="team/'+e.Team+"/\"><span style=\"display:inline-block;width:20px;height:20px;vertical-align: text-bottom;background:url('images/NFLTeamLogos.png') 0px -"+20*e.Team_logo_id+'px;background-size:100%;"></span> '+e.Team_preffered_name+"</a> ")})}function loadingFinished(){setupArrestOMeter(),nflLoadingBar.hideLoading(),listsReturned=!1,mainChartReturned=!1,setupFacebook(),setupTwitter(),$("#newsletterForm").submit(function(t){t.preventDefault(),$.ajax({url:"http://patrickmurphywebdesign.com/Projects/emails/emailList.php",type:"POST",data:{email:$("input[name=email]").val()}}),$("#newsletterForm").html("<p>Thanks for Subscribing! Expect Emails when Players are arrested or when records are broken!</p>"),googleTracking.sendTrackEvent("Email List","Subscribe")}),$("#newsletterForm input[name=email]").focus(function(){googleTracking.sendTrackEvent("Email List","Focus")})}function setupArrestOMeter(){$.getJSON("http://nflarrest.com/api/v1/meter",function(t){var e=t.current.daysSince,a=t.alltime.record,n=t.alltime.average,o=parseInt(e)/a;$("#arrest_meter_text").html("It has been <b>"+e+"</b> Days since the last arrest.</p>"),$("#arrest_meter_subtext").html("Average: <b>"+n+"</b> Days | Record W/O arrest: <b>"+a+"</b> Days"),$(".recordHolder").html(a),$(".avgRecord").html(n),$(".meter-fg").animate({width:100*o+"%"},1750)})}function changeTopChart(){setupChart(),1==mainChartStyleID?($(".mainChartBtn").removeClass("button-primary"),$("#mainChartByYearBtn").addClass("button-primary")):0==mainChartStyleID?($(".mainChartBtn").removeClass("button-primary"),$("#mainChartByTeamBtn").addClass("button-primary")):2==mainChartStyleID?($(".mainChartBtn").removeClass("button-primary"),$("#mainChartBySeasonBtn").addClass("button-primary")):3==mainChartStyleID?($(".mainChartBtn").removeClass("button-primary"),$("#mainChartByConfBtn").addClass("button-primary")):4==mainChartStyleID&&($(".mainChartBtn").removeClass("button-primary"),$("#mainChartByConfDivBtn").addClass("button-primary"))}function getOverallChartData(t){1==mainChartStyleID?$.getJSON("http://nflarrest.com/api/overall/customStackedBar.php?bar_col=Year&stack_col=Crime&bar_order_dir=ASC&order_dir=DESC&bar_order_col=Year&legend_order_col=Measure&start_date="+dateRangeNFL.getStart()+"&end_date="+dateRangeNFL.getEnd(),t):0==mainChartStyleID?$.getJSON("http://nflarrest.com/api/overall/topTeams.php?graph=true&start_date="+dateRangeNFL.getStart()+"&end_date="+dateRangeNFL.getEnd(),t):2==mainChartStyleID?$.getJSON("http://nflarrest.com/api/v1/ArrestsSeasonState?start_date="+dateRangeNFL.getStart()+"&end_date="+dateRangeNFL.getEnd(),t):3==mainChartStyleID?$.getJSON("http://nflarrest.com/api/overall/customStackedBar.php?bar_col=Day&stack_col=Crime&bar_order_dir=ASC&order_dir=DESC&bar_order_col=DayOrder&legend_order_col=Measure&start_date="+dateRangeNFL.getStart()+"&end_date="+dateRangeNFL.getEnd(),t):4==mainChartStyleID&&$.getJSON("http://nflarrest.com/api/overall/conferenceDivisionByYear.php?graph=true&start_date="+dateRangeNFL.getStart()+"&end_date="+dateRangeNFL.getEnd(),t)}function setupChart(){void 0!==stackedBarChart.stackedChart&&stackedBarChart.stackedChart.destroy(),getOverallChartData(function(t){stackedBarChart.init({data:t,targetElement:"#chart",targetExpandBtn:"#details_summary_btn",hideBtn:"#hideAll_btn",showBtn:"#showAll_btn"}),mainChartReturned=!0,listsReturned&&loadingFinished()})}function load_top_list(t,e,a,n,o,r){(r=r||!1)&&(last_start_pos=0);var s=[];t.length>0?$.each(t,function(t,n){var r='<a href="'+e+"/"+n[o[0]]+'/">',i="</a>";""==e&&(r="",i=""),s.push("<li id='"+a+t+"'>"+r+"<span>"+n[o[0]]+"</span><span class='value-cell'>"+n[o[1]]+"</span>"+i+"</li>")}):r&&s.push('<li class="list-no-data-msg-item">No Data Available for this Date Range</li>'),r?$(n).html(s.join("")):$(n).append(s.join(""))}function load_top_crimes_list(t){load_top_list("http://nflarrest.com/api/overall/topCrimes.php?limit=5&start_pos="+last_start_pos,"crime","top_crime_","#top_crimes_list",["Category","arrest_count"],t=t||!1)}function load_top_players_list(t){load_top_list("http://nflarrest.com/api/overall/topPlayers.php?limit=5&start_pos="+last_start_pos,"player","top_player_","#top_players_list",["Name","arrest_count"],t=t||!1)}function load_top_positions_list(t){load_top_list("http://nflarrest.com/api/overall/topPositions.php?limit=5&start_pos="+last_start_pos,"position","top_pos_","#top_positions_list",["Position","arrest_count"],t=t||!1)}function load_top_lists(t,e){t=t||"not first",e=e||!1,$(".list-no-data-msg-item").remove(),"first"!=t&&googleTracking.sendTrackEvent("TopLists","Load Next Page");var a="http://nflarrest.com/api/overall/topLists.php?limit=5&start_pos="+last_start_pos+"&start_date="+dateRangeNFL.getStart()+"&end_date="+dateRangeNFL.getEnd();$.getJSON(a,function(t){var a=t[0],n=t[1],o=t[2];a.length+n.length+o.length<=0&&0==last_start_pos&&console.log("no data returned"),load_top_list(a,"crime","top_crime_","#top_crimes_list",["Category","arrest_count"],e),load_top_list(n,"player","top_player_","#top_players_list",["Name","arrest_count"],e),load_top_list(o,"position","top_pos_","#top_positions_list",["Position","arrest_count"],e),listsReturned=!0,listsReturnCount=0,last_start_pos+=5,!0===mainChartReturned&&loadingFinished()})}function reload_top_lists(){last_start_pos=0,load_top_lists("not first",!0)}function gaEvent(t,e,a,n,o){googleTracking.sendTrackEvent(a,n)}function setupFacebook(){console.log("FB Setup"),window.fbAsyncInit=function(){FB.init({appId:"563956043742586",xfbml:!0,version:"v2.4"}),FB.Event.subscribe("edge.create",function(t){gaEvent("send","social","facebook","like",t)}),FB.Event.subscribe("edge.remove",function(t){gaEvent("send","social","facebook","unlike",t)}),FB.Event.subscribe("message.send",function(t){gaEvent("send","social","facebook","send",t)})},function(t,e,a){var n,o=t.getElementsByTagName(e)[0];t.getElementById(a)||((n=t.createElement(e)).id=a,n.src="//connect.facebook.net/en_US/sdk.js",o.parentNode.insertBefore(n,o))}(document,"script","facebook-jssdk")}function setupTwitter(){console.log("twitter setup"),window.twttr=function(t,e,a){var n,o=t.getElementsByTagName(e)[0],r=window.twttr||{};return t.getElementById(a)?r:(n=t.createElement(e),n.id=a,n.src="https://platform.twitter.com/widgets.js",o.parentNode.insertBefore(n,o),r._e=[],r.ready=function(t){r._e.push(t)},r)}(document,"script","twitter-wjs"),twttr.ready(function(t){t.events.bind("tweet",function(t){if(t){var e=window.location.href;t.target&&"IFRAME"==t.target.nodeName&&(e=extractParamFromUri(t.target.src,"url")),gaEvent("send","social","twitter","tweet",e),console.log("thanks for sharing",e)}})})}function update_hash(){pageID=window.location.hash||"#!ID Not Set",pageID=pageID.replace("#!",""),pageID=pageID.replace("#",""),$("#pageTitle").append(pageID)}function extractParamFromUri(t,e){if(t){var a=new RegExp("[\\?&#]"+e+"=([^&#]*)").exec(t);return null!=a?unescape(a[1]):void 0}}function loadCSS(t){!function(e,a){var n=e.createElement(a),o=e.getElementsByTagName(a)[0];n.href=t,n.rel="stylesheet",o.parentNode.insertBefore(n,o)}(document,"LINK")}var hashervar=window.location.hash||"",pagePath=window.location.pathname+hashervar;!function(t,e,a,n,o,r,s){t.GoogleAnalyticsObject=o,t[o]=t[o]||function(){(t[o].q=t[o].q||[]).push(arguments)},t[o].l=1*new Date,r=e.createElement(a),s=e.getElementsByTagName(a)[0],r.async=1,r.src="//www.google-analytics.com/analytics.js",s.parentNode.insertBefore(r,s)}(window,document,"script",0,"ga"),$.getJSON("api/UUID.php",function(t){t.hasOwnProperty("UUID")?ga("create","UA-66360026-1","auto"):ga("create","UA-66360026-1","auto"),ga("send","pageview",pagePath)});var googleTracking={tracker:void 0,initialize:function(t){googleTracking.tracker=t},sendTrackEvent:function(t,e){arguments.length<3&&ga("send","event",t,e)}};googleTracking.initialize(ga);var dateRangeNFL,mainChartReturned=!1,last_start_pos=0,listsReturnCount=0,listsReturned=!1,ytdChart=!1,mainChartStyleID=0;$(window).load(function(){dateRangeController.init(function(t){nflLoadingBar.init(),dateRangeNFL=t,window.location.hash&&(mainChartStyleID="#ByYear"==window.location.hash?1:"#BySeason"==window.location.hash?2:0),changeTopChart(),load_top_lists("first"),$("#dateRangeJquery").on("dateRangeChanged",function(t){nflLoadingBar.showLoading(),setupChart(),reload_top_lists()}),$("#loadMoreLists").click(load_top_lists),$.getJSON("http://nflarrest.com/api/v1/team",loadTeamLinks),$("#mainChartByTeamBtn").click(function(){ytdChart=!1,mainChartStyleID=0,window.location.hash="ByTeam",changeTopChart(),googleTracking.sendTrackEvent("mainChart","switchToByTeam")}),$("#mainChartByYearBtn").click(function(){ytdChart=!0,mainChartStyleID=1,window.location.hash="ByYear",changeTopChart(),googleTracking.sendTrackEvent("mainChart","switchToByYear")}),$("#mainChartBySeasonBtn").click(function(){ytdChart=!1,mainChartStyleID=2,window.location.hash="BySeason",changeTopChart(),googleTracking.sendTrackEvent("mainChart","switchToBySeason")}),$("#mainChartByConfBtn").click(function(){ytdChart=!0,mainChartStyleID=3,window.location.hash="ByDayOfWeek",changeTopChart(),googleTracking.sendTrackEvent("mainChart","switchToByDayOfWeek")}),$("#mainChartByConfDivBtn").click(function(){ytdChart=!0,mainChartStyleID=4,window.location.hash="ByDivision",changeTopChart(),googleTracking.sendTrackEvent("mainChart","switchToByDivision")})})});var isFirstHover=!0,stackedBarChart={stackedChart:void 0,options:{targetElement:"#theElementSelector",targetExpandBtn:"#btnSelector",showBtn:"#btnSelector",hideBtn:"#btnSelector",data:{},isExpanded:!1,customLegend:!0,zoomEnabled:!1},init:function(t){this.options.data={},$.extend(!0,this.options,t);var e=this;console.log("Initialize Chart:  "+this.options.targetElement),e.options.$targetElement=$(this.options.targetElement),e.options.$expandBtnElement=$(this.options.targetExpandBtn),e.options.$showBtnElement=$(this.options.showBtn),e.options.$hideBtnElement=$(this.options.hideBtn),stackedBarChart.options.$expandBtnElement.off("click"),stackedBarChart.options.$expandBtnElement.click(e.toggleExpand),stackedBarChart.options.$hideBtnElement.click(e.hideAllCategories),stackedBarChart.options.$showBtnElement.click(e.showAllCategories),e.renderChart()},renderChart:function(){if($(document).width()<800)t=20;else var t=6;stackedBarChart.stackedChart=c3.generate({bindto:stackedBarChart.options.targetElement,data:{empty:{label:{text:"No Data Available for this Date Range"}},x:"x",columns:stackedBarChart.options.data.columns,groups:[stackedBarChart.options.data.groups],order:"asc",type:"bar",onclick:function(t,e){void 0!==mainChartStyleID&&0==mainChartStyleID&&(googleTracking.sendTrackEvent("mainChart","teamLink"),setTimeout(function(){window.location.href="team/"+stackedBarChart.options.data.columns[0][t.index+1]+'/'},100))}},zoom:{enabled:stackedBarChart.options.zoomEnabled},padding:{bottom:t},legend:{show:!stackedBarChart.options.customLegend},axis:{x:{type:"category"}},color:{pattern:["#1F77B4","#FF7F0E","#2CA02C","#D62728","#9467BD","#8C564B","#E377C2","#7F7F7F","#BCBD22","#17BECF","#154F78","#B0580A","#248224","#7D1717"]}}),stackedBarChart.options.customLegend&&stackedBarChart.renderCustomLegend()},renderCustomLegend:function(){$(".customLegend").remove(),d3.select(".chart-container").insert("div",".chart-options").attr("class","customLegend").selectAll("span").data(stackedBarChart.options.data.groups).enter().append("span").attr("data-id",function(t){return t}).attr("class",function(t){var e=t.replace("/","");return"customLegend-item customLegend-item-"+(e=e.split(" ").join(""))}).html(function(t){return'<span class="customLegend-item-color" style="background-color:'+stackedBarChart.stackedChart.color(t)+';"></span> '+t}).on("mouseover",function(t){stackedBarChart.stackedChart.focus(t),isFirstHover&&(isFirstHover=!1,googleTracking.sendTrackEvent("mainChart","legendMouseover"))}).on("mouseout",function(t){stackedBarChart.stackedChart.revert()}).on("click",function(t){stackedBarChart.stackedChart.toggle(t);var e=t.replace("/","");e=e.split(" ").join("");var a=d3.select(".customLegend-item-"+e);console.log(a),a.classed("transparent",!a.classed("transparent")),googleTracking.sendTrackEvent("mainChart","legendClick")})},toggleExpand:function(){stackedBarChart.options.$targetElement.toggleClass("expanded"),stackedBarChart.options.isExpanded=!stackedBarChart.options.isExpanded,stackedBarChart.options.isExpanded?stackedBarChart.options.$expandBtnElement.html("Collapse"):stackedBarChart.options.$expandBtnElement.html("Expand"),googleTracking.sendTrackEvent("mainChart","expand toggle"),stackedBarChart.renderChart()},hideAllCategories:function(){stackedBarChart.stackedChart.hide(),googleTracking.sendTrackEvent("mainChart","hideAll"),$(".customLegend-item").addClass("transparent")},showAllCategories:function(){stackedBarChart.stackedChart.show(),googleTracking.sendTrackEvent("mainChart","showAll"),$(".customLegend-item").removeClass("transparent")}},dateRangeController={start_date:"2000-01-01",end_date:"",init:function(t){if("undefined"!=typeof pageID)"#!"+(pageID||"");else;$("#dateRangeJquery").daterangepicker({presetRanges:[{text:"Last 3 Months",dateStart:function(){return moment().subtract("months",3)},dateEnd:function(){return moment()}},{text:"Last 6 Months",dateStart:function(){return moment().subtract("months",6)},dateEnd:function(){return moment()}},{text:"Last Year",dateStart:function(){return moment().subtract("years",1)},dateEnd:function(){return moment()}},{text:"Last 5 Years",dateStart:function(){return moment().subtract("years",5)},dateEnd:function(){return moment()}},{text:"All Records",dateStart:function(){return moment("2000-01-01")},dateEnd:function(){return moment()}}],datepickerOptions:{minDate:new Date("2000-01-01"),maxDate:0}});var e=moment().format("YYYY-MM-DD");this.start_date=this.getCookie("start_date")||"2000-01-01",this.end_date=this.getCookie("end_date")||e,$("#dateRangeJquery").daterangepicker("setRange",{start:moment(this.start_date).toDate(),end:moment(this.end_date).toDate()}),$("#dateRangeJquery").on("change",this.changeDateRange),$("#dateRangeJquery").on("open",function(){googleTracking.sendTrackEvent("DateRange","OpenDialog")}),t(this)},resetTime:function(t){googleTracking.sendTrackEvent("DateRange","Reset"),t=t||!1;var e,a,n=new Date;e=n.getMonth()<9?"0"+(n.getMonth()+1):n.getMonth()+1,a=n.getDate()<10?"0"+n.getDate():n.getDate();var o=n.getFullYear()+"-"+e+"-"+a;dateRangeController.setDates("2000-01-01",o)},getStart:function(){return this.start_date},getEnd:function(){return this.end_date},changeDateRange:function(){var t=JSON.parse($("#dateRangeJquery").val());console.log(t);var e=t.start,a=t.end;if(new Date(e)>new Date(a)){var n=e;e=a,a=n}dateRangeController.setDates(e,a)},setDates:function(t,e){if(dateRangeController.setCookie("start_date",t),dateRangeController.setCookie("end_date",e),dateRangeController.start_date=t,dateRangeController.end_date=e,window.CustomEvent){new Event("dateRangeChanged");$("#dateRangeJquery").trigger("dateRangeChanged"),googleTracking.sendTrackEvent("DateRange","DateChanged")}},setCookie:function(t,e,a){var n=new Date;a=a||.5,n.setTime(n.getTime()+24*a*60*60*1e3);var o="expires="+n.toUTCString();document.cookie=t+"="+e+"; "+o},getCookie:function(t){for(var e=t+"=",a=document.cookie.split(";"),n=0;n<a.length;n++){for(var o=a[n];" "==o.charAt(0);)o=o.substring(1);if(0==o.indexOf(e))return o.substring(e.length,o.length)}return""}},nflLoadingBar={options:{targetEl:"body",loadingElID:"loading-bar",message:"Loading..."},init:function(){$(this.options.targetEl).append('<div id="'+this.options.loadingElID+'">'+this.options.message+"</div>"),this.showLoading()},hideLoading:function(){$("#"+nflLoadingBar.options.loadingElID).fadeOut()},showLoading:function(){$("#"+nflLoadingBar.options.loadingElID).fadeIn()}};loadCSS("css/styles.min.css"),loadCSS("//fonts.googleapis.com/css?family=Raleway:400,300,500,600"),loadCSS("css/vendor/normalize.min.css"),loadCSS("css/vendor/skeleton.min.css"),loadCSS("css/vendor/c3.css"),loadCSS("css/vendor/jquery-ui.min.css"),loadCSS("css/vendor/jquery.comiseo.daterangepicker.css");