class LoadingBarManager{constructor(){

this.options={targetEl:"body",
loadingElID:"loading-bar",
message:"Loading..."}
;this.reset()}reset(){if(




$("#"+this.options.loadingElID).length){
this.showLoading()}else{

$(this.options.targetEl).append('<div id="'+this.options.loadingElID+'">'+this.options.message+"</div>")
;this.showLoading()}}hideLoading(){




$("#"+this.options.loadingElID).fadeOut()}showLoading(){



$("#"+this.options.loadingElID).fadeIn()}}class Module{constructor(e,t,a,i){this.setModuleID(e);this.setParent(t);this.setData(a);this.setOptions(i)}renderView(){console.warn("Default Module renderView Function called.")}setModuleID(e){this.moduleID=e}getModuleID(){return this.moduleID}setParent(e){this.parent=e}getParent(){

return this.parent}validateDataFormat(



e){if(
e){
return true}else{

return false}}setData(



e){if(

this.validateDataFormat(e)){
this.data=e}else{

console.error("Invalid Data Format -- "+this.getModuleID())}}getData(){




return this.data}setOptions(


e){
this.options=e}setOption(


e,t){
this.options[e]=t}getOptions(){



return this.options}getOption(


e,t){
var a=this.options[e];if(
t){
a=a[t]}

return a}getOptionExists(


e){
return this.getOptions().hasOwnProperty(e)}getHTML(){




return"\x3c!-- NO HTML Defined for Module: "+this.getModuleID()+" --\x3e"}getCSSIncludes(){



return"\x3c!-- NO CSS Includes Defined for Module: "+this.getModuleID()+" --\x3e"}getJSIncludes(){



return"\x3c!-- NO JS Includes Defined for Module: "+this.getModuleID()+" --\x3e"}}class DataTable extends Module{constructor(e,t,a){super("DataTable",e,t,a||{targetElement:"arrest_table",targetElementMobile:"arrest_cards",targetElementTableContainer:"arrest_details_container",targetElementTitleIncidentCount:"arrest_details_incident_count",TitlePrefix:"",RowLimit:15,GoogleTrackingCategory:"DetailPageArrests"});this.renderRowFn=undefined;this.renderRowHeaderFn=undefined;this.renderCardFn=undefined;this.displayDataFilterFn=undefined;this.displayPaginationTemplateFn=undefined;this.displayDataCallbackFn=undefined;this.setupDefaultFunctions();this.setOption("afterInit",false);if(this.getOptionExists("renderRowHeaderFn")){this.setRenderRowHeaderFn(this.getOption("renderRowHeaderFn"))}if(this.getOptionExists("renderRowFn")){this.setRenderRowFn(this.getOption("renderRowFn"))}if(this.getOptionExists("renderCardFn")){this.setRenderCardFn(this.getOption("renderCardFn"))}this.view_mobile=this.parent.Utilities.mobileCheck()?true:false;this.DataTableColumns=undefined;if(this.getOptionExists("columns")){this.DataTableColumns=new DataTableColumns(this,this.getOption("columns"),{columns:this.getOption("columns")})}this.renderView()}setupDefaultFunctions(){var s=this;this.defaultFunctions={};this.defaultFunctions.displayDataFilterFn=e=>{if(s.parent.pageTitle=="Team"){if(e["Team"]!=s.parent.pageID){return false}}else if(s.parent.pageTitle=="Position"){if(e["Position"]!=s.parent.pageID){return false}}else if(s.parent.pageTitle=="Player"){if(e["Name"]!=s.parent.pageID){return false}}else if(s.parent.pageTitle=="Crime"){if(e["Category"]!=s.parent.pageID){return false}}else if(s.parent.pageTitle=="Crime Category"){if(e["Crime_category"]!=s.parent.pageID){return false}}return true};this.defaultFunctions.displayPaginationTemplateFn=(e,t)=>{var a=[];if(!s.view_mobile){
a.push(s.renderRowHeader())}for(



var i in e){
var r=e[i]
;var n=s.getData()[r];if(
s.view_mobile){
a.push(s.renderCard(n))}else{

a.push(s.renderRow(n))}}if(



s.view_mobile){

$("#"+s.getOption("targetElementMobile")).html(a.join(""))}else{


$("#"+s.getOption("targetElement")).html(a.join(""))}}


;this.defaultFunctions.displayDataCallbackFn=e=>{
s.setupContainerElements(e)
;s.parent.checkLoadingFinished()}}setupContainerTitle(





e){
var t=this.getOption("targetElementTableContainer")||"arrest_details_container"
;var a=this.getOption("targetElementTitleIncidentCount")||"arrest_details_incident_count"
;var i=this.getOption("TitlePrefix")||""


;$("#"+t).html('<h4 id="'+a+'" style="text-align:left;"># Incidents:</h4>')
;$("#"+a).html(i+e.length+" Incidents:")}setupContainerElements(





e){
var t=this.getOption("targetElementTitleIncidentCount")||"arrest_details_incident_count";if(

this.view_mobile){

$("#"+t).after('<div id="'+this.getOption("targetElementMobile")+'"></div>')

;$("#"+this.getOption("targetElementMobile")).after('<div id="pagination-control"></div>')}else{


$("#"+t).after('<table id="'+this.getOption("targetElement")+'"></table>')

;$("#"+this.getOption("targetElement")).after('<div id="pagination-control"></div>')}}setupPagination(



e){
$("#pagination-control").pagination({
dataSource:Array.from(this.getData().keys()),
callback:this.displayPaginationTemplateFn||this.defaultFunctions.displayPaginationTemplateFn,afterPreviousOnClick:()=>{







this.parent.Utilities.googleTracking.sendTrackEvent(this.getOption("GoogleTrackingCategory"),"Change Page : Previous Button")},afterPageOnClick:()=>{


this.parent.Utilities.googleTracking.sendTrackEvent(this.getOption("GoogleTrackingCategory"),"Change Page : Page Button")},afterNextOnClick:()=>{


this.parent.Utilities.googleTracking.sendTrackEvent(this.getOption("GoogleTrackingCategory"),"Change Page : Next Button")},afterGoInputOnEnter:()=>{


this.parent.Utilities.googleTracking.sendTrackEvent(this.getOption("GoogleTrackingCategory"),"Change Page : Go Input On Enter")},afterGoInputOnClick:()=>{


this.parent.Utilities.googleTracking.sendTrackEvent(this.getOption("GoogleTrackingCategory"),"Change Page : Go Input On Click")},afterInit:()=>{


this.setOption("afterInit",true)},

autoHidePrevious:true,
autoHideNext:true,
showNavigator:true,
className:"paginationjs-theme-yellow paginationjs-big",
pageSize:this.view_mobile?5:this.getOption("RowLimit"),
pageRange:this.view_mobile?1:2})}validateDataFormat(



e){


return true}sortData(



a,i){

this.data.sort(function(e,t){if(
i


)return e[a]>t[a];else return e[a]<t[a]})}renderView(){





var i=this





;var e=i.displayDataFilterFn||i.defaultFunctions.displayDataFilterFn

;var t=i.displayPaginationTemplateFn||i.defaultFunctions.displayPaginationTemplateFn

;var a=e=>{
i.setData(e)
;i.setupContainerTitle(e)
;var t=i.displayDataCallbackFn||i.defaultFunctions.displayDataCallbackFn
;var a=e=>{
t(e)}

;a(e)
;i.setupPagination(e)}



;i.parent.data_controller.getArrests(e,a)}renderCard(


e){if(
this.renderCardFn){
return this.renderCardFn(e)}else{

var t=new ArrestCard(this.parent,e)
;return t.getHTML()}}renderRowHeader(){if(





this.renderRowHeaderFn){

return this.renderRowHeaderFn()}else if(
this.DataTableColumns){

return this.DataTableColumns.renderRowColumns("header")}else{



var e="<tr>"
;e+='<th class="one column">Date:</th>'
;e+='<th class="one column">Team:</th>'
;e+='<th class="two columns">Player:</th>'
;e+='<th class="one column">Crime:</th>'
;e+='<th class="four columns">Description:</th>'
;e+='<th class="three columns">Outcome:</th>'
;e+="</tr>"

;return e}}renderRow(




e){if(
this.renderRowFn){

return this.renderRowFn(e)}else if(
this.DataTableColumns){

return this.DataTableColumns.renderRowColumns(e)}else{



var t="<tr>"
;t+='<td class="one column" '+this.parent.getHTMLDateTitleAttribute(e)+">"+moment(e["Date"],"YYYY-MM-DD").fromNow()+"</td>"
;t+='<td class="one column">'+e["Team"]+"</td>"
;t+='<td class="two columns"><a href="Player.html#'+e["Name"]+'">'+e["Name"]+"</a></td>"
;t+='<td class="one column"><a href="CrimeCategory.html#'+e["Crime_category"]+'">'+e["Crime_category"]+"</a></td>"
;t+='<td class="four columns">'+e["Description"]+"</td>"
;t+='<td class="three columns">'+e["Outcome"]+"</td>"
;t+="</tr>"

;return t}}setDataFilterFn(




e){
this.displayDataFilterFn=e}setRenderRowHeaderFn(


e){
this.renderRowHeaderFn=e}setRenderRowFn(


e){
this.renderRowFn=e}setRenderCardFn(


e){
this.renderCardFn=e}setDataCallbackFn(


e){
this.displayDataCallbackFn=e}setColumns(


e){if(
this.getOptionExists("columns")||e){
var t=e||this.getOption("columns")
;this.DataTableColumns=new DataTableColumns(this,t,{columns:t})}}}class DataTableColumns extends Module{constructor(e,t,a){super("DataTableColumn",e,t,a||{columns:[{column_id:0,column_title:"Column Name",column_data:"col",column_classes:"",column_width:2}]})}convertIntToWord(e){var t="zero one two three four five six seven eight nine ten eleven twelve".split(" ");if(e<=12&&e>0){return t[e]}else{return t[1]}}renderColumnAttributes(e){return this.renderColumnAttributeClass(e)}renderColumnAttributeClass(e){var t="";if(e.hasOwnProperty("column_width")||e.hasOwnProperty("column_classes")){t+=' class="';if(e.hasOwnProperty("column_width")){var a=parseInt(e["column_width"]);if(a>0&&a<=12){t+=this.convertIntToWord(a);t+=" column";if(a>1){t+="s"}}else{t+="one column"}}else{t+="one column"}if(e.hasOwnProperty("column_classes")){t+=" "+e["column_classes"]}t+='"'}return t}renderRowColumns(e){var t=!(e=="header"||e==["header"]||e=={header:true});var a=t?"td":"th";var i=this.getOption("columns");var r="<tr>";for(var n=0;n<i.length;n++){var s=i[n];r+="<"+a+this.renderColumnAttributes(s)+">";if(t){r+=s.hasOwnProperty("column_display_fn")?s.column_display_fn(e):e[s.column_data]}else{r+=s.column_title}r+="</"+a+">"}r+="</tr>";return r}}class ArrestCard extends Module{constructor(e,t,a){super("ArrestCard",e,t,a||{showName:false,momentDate:false,standalone:false});this.options.momentDate=this.getData()["DaysSince"]>99;this.dimensions={};this.addDimensions()}validateDataFormat(e){if(!e.hasOwnProperty("Team_preffered_name")){throw"error: incorrect row definition";return false}else{return true}}addDimensions(){this.dimensions["Team"]={dimension_id:0,dimension_name:"Team",data_column:"Team",color:"Team_hex_color",url:"Team.html",display:"Team_preffered_name",color2:"Team_hex_alt_color",useColor2:true};this.dimensions["Player"]={dimension_id:2,dimension_name:"Player",data_column:"Name",color:"Team_hex_color",url:"Player.html",display:"Name",color2:"Team_hex_alt_color",useColor2:true};this.dimensions["Position"]={dimension_id:3,dimension_name:"Position",data_column:"Position",color:"Team_hex_color",url:"Position.html",display:"Position_name",color2:"Team_hex_alt_color",useColor2:true};this.dimensions["Crime"]={dimension_id:1,dimension_name:"Crime",data_column:"Category",color:"Crime_category_color",url:"Crime.html",display:"Category"};this.dimensions["CrimeCategory"]={dimension_id:4,dimension_name:"Crime Category",data_column:"Crime_category",color:"Crime_category_color",url:"CrimeCategory.html",display:"Crime_category"};this.Dimension_Team=this.dimensions["Team"];this.Dimension_Player=this.dimensions["Player"];this.Dimension_Position=this.dimensions["Position"];this.Dimension_Crime=this.dimensions["Crime"];this.Dimension_Crime_Category=this.dimensions["CrimeCategory"]}getHTML(e,t,a,i){var e=e||this.dimensions["Crime"];var t=t||this.dimensions["Team"];var i=i||{};var r=a||{};var n=this.getData();var s=this.options.showName?' style="display:inline-block; visibility:visible;"':"";var o=this.options.momentDate?moment(n["Date"],"YYYY-MM-DD").fromNow():n["DaysSince"]+" days ago";var l=t.useColor2?'style="color:#'+n[t.color2]+';"':"";var h=this.options.standalone?" standalone_card":"";var d='<a href="'+r.url+"#"+n[r.data_column]+'">'+n[r.display]+"</a>";var c=['<div class="card arrest_card '+h+'">'];c.push('<span class="date_item" title="'+n["Date"]+'">'+o+"</span>");if(r.hasOwnProperty("data_column")>0){c.push('<span class="bottom_right_item">'+d+"</span>")}c.push('<span class="name_item"'+s+'><a href="Player.html#'+n["Name"]+'">'+n["Name"]+"</a> </span>");c.push("<br />");c.push('<span class="crime_item" style="background-color:#'+n[e.color]+'">');c.push('<a href="'+e.url+"#"+n[e.data_column]+'">'+n[e.display]+"</a> </span>");c.push('<span class="team_item '+n[t.data_column]+'" style="background-color:#'+n[t.color]+';">');c.push('<a href="'+t.url+"#"+n[t.data_column]+'" '+l+" >"+n[t.display]+"</a></span>");if(i.hasOwnProperty("data_column")){c.push('<br /><span class="arrest_card_detail_links">'+i.dimension_name+': <a href="'+i.url+"#"+n[i.data_column]+'">'+n[i.data_column]+"</a></span>")}c.push("<br />");c.push('<span class="description_item">'+n["Description"]+"</span>");c.push('<span class="outcome_item">'+n["Outcome"]+"</span>");c.push("</div>");var m=c.join("");return m}}var lastUpdate="3/14/2022, 3:13:58 AM";var lastVersion="2.34.41";class DataController{constructor(e,t){this.DateRangeControl=e;this.parent=t;this.data=this.ConvertArrayToObjects(ArrestsCacheTableArr);this.PreProcessData()}ConvertArrayToObjects(e){var t=[];for(var a=0;a<e.length;a++){t.push(this.ConvertArrayToObject(e[a]))}return t}ConvertArrayToObject(e){var t={};var a=["arrest_stats_id","Date","Team","Team_name","Team_preffered_name","Team_city","Team_logo_id","Team_Conference","Team_Division","Team_Conference_Division","Team_hex_color","Team_hex_alt_color","Name","Position","Position_name","Position_type","Encounter","Category","Crime_category","Crime_category_color","Description","Outcome","Season","ArrestSeasonState","general_category_id","legal_level_id","resolution_category_id","Year","Month","Day","Day_of_Week","Day_of_Week_int","YearToDate","DaysSince","DaysToLastArrest","DaysToLastCrimeArrest","DaysToLastTeamArrest"];if(a.length>=e.length){for(var i=0;i<e.length;i++){t[a[i]]=e[i]}}return t}PreProcessData(){this.PreProcessData_DaysSince();this.PreProcessData_YearToDate();this.PreProcessData_SortOrder()}PreProcessData_DaysSince(){var a=function(e,t){var a=Date.UTC(e.getFullYear(),e.getMonth(),e.getDate());var i=Date.UTC(t.getFullYear(),t.getMonth(),t.getDate());return Math.floor((i-a)/(1e3*60*60*24))};this.forEach((e,t)=>{this.data[t].DaysSince=a(new Date(e.Date),new Date)})}PreProcessData_YearToDate(){var n=function(e,t){var a=Date.UTC(e.getFullYear(),e.getMonth(),e.getDate());var i=Date.UTC(t.getFullYear(),t.getMonth(),t.getDate());return Math.floor((i-a)/(1e3*60*60*24))};this.forEach((e,t)=>{var a=new Date((new Date).getFullYear(),0,1);var i=new Date;var r=n(a,i);this.data[t].YearToDateStatus=r>e.YearToDate?"Year To Date":"Future Period"})}PreProcessData_SortOrder(){function e(e,t){if(e.DaysSince<t.DaysSince){return 1}if(e.DaysSince>t.DaysSince){return-1}return 0}this.data.sort(e)}forEach(e,t,a){t=t||function(){};a=a||true;for(var i=this.data.length-1;i>=0;i--){var r=this.data[i];if(a){if(this.dateLimit(r,this.DateRangeControl.getStart(),this.DateRangeControl.getEnd())){e(r,i)}}else{e(r,i)}}t()}incrementMap(e,t){if(!e.hasOwnProperty(t)){e[t]=1}else{e[t]=e[t]+1}return e}dateLimit(e,t,a){t=t||this.start_date;a=a||this.end_date;return new Date(e.Date)>=new Date(t)&&new Date(e.Date)<=new Date(a)}getActivePlayerArrests(e){e(["no data"])}getMostRecentArrest(e){var t;var a=999999999;this.forEach(e=>{if(this.dateLimit(e,this.DateRangeControl.getStart(),this.DateRangeControl.getEnd())){if(e.DaysSince<a){t=e;a=e.DaysSince}}},()=>{e(t)})}getTeams(e,t){var a=t||(e=>{return this.dateLimit(e,this.DateRangeControl.getStart(),this.DateRangeControl.getEnd())});var i=[];var r={};var n={};var s=new Map;for(var o=this.data.length-1;o>=0;o--){var l=this.data[o];if(a(l)){var h={Team:l.Team,Team_name:l.Team_name,Team_preffered_name:l.Team_preffered_name,Team_logo_id:l.Team_logo_id,Team_Conference:l.Team_Conference,Team_Division:l.Team_Division,Team_Conference_Division:l.Team_Conference_Division,Team_Arrest_Count:1};if(!s.has(l.Team)){s.set(l.Team,1);r[l.Team]=i.length;n[l.Team]=h}else{s.set(h.Team,s.get(h.Team)+1);n[l.Team]["Team_Arrest_Count"]++}}}for(var d=Object.keys(n).length-1;d>=0;d--){var c=n[Object.keys(n)[d]];i.push(c)}i.sort(function(e,t){if(e.Team_Arrest_Count>t.Team_Arrest_Count){return-1}else if(e.Team_Arrest_Count<t.Team_Arrest_Count){return 1}else{return 0}});e(i)}getArrestMeter(e){var a=0;var i=-1;var r=0;var n=9e9;this.forEach((e,t)=>{r++;a+=e.DaysToLastArrest;if(e.DaysToLastArrest>i){i=e.DaysToLastArrest}if(e.DaysSince<n){n=e.DaysSince}});a=a/r;e({alltime:{record:Math.floor(i),average:Math.floor(a),raw_average:Math.floor(a)},current:{daysSince:Math.floor(n),probability:Math.exp(n*-1)/a,odds:Math.floor(1/Math.exp(n*-1/a))}})}getDonutChart(a,e,t){var i=function(e,t){return t.arrest_count-e.arrest_count};var r={};var n=[];for(var s=this.data.length-1;s>=0;s--){var o=this.data[s];if(e(o)&&this.dateLimit(o,this.DateRangeControl.getStart(),this.DateRangeControl.getEnd())){r=this.incrementMap(r,o[a])}}Object.keys(r).forEach(e=>{var t={};t[a]=e;t["arrest_count"]=r[e];n.push(t)});t(n.sort(i))}getOverallChart(e,t,a,i,r){var n={};n["Year"]="Year";n["Month"]="Month";n["Day"]="Day_of_Week";n["DayOrder"]="Day_of_Week_int";n["YearToDate"]="YearToDateStatus";n["Team"]="Team_preffered_name";n["Team Code"]="Team";n["Conference"]="Team_Conference";n["Division"]="Team_Conference_Division";n["Position"]="Position";n["Crime"]="Crime_category";n["Season"]="Season";n["SeasonState"]="ArrestSeasonState";n["Measure"]="arrest_count";var s=n[t];var o=n[e];var l=n[a];var h=i;var d="Measure";var c="ASC";var m=l;var u=h;var g;var p={};var f={};var _={};var v={};var C=[];var D=[];var y={};var w=function(e,t){return t.arrest_count-e.arrest_count};var T=function(e,t){return e.arrest_count-t.arrest_count};for(var b=this.data.length-1;b>=0;b--){var k=this.data[b];if(this.dateLimit(k,this.DateRangeControl.getStart(),this.DateRangeControl.getEnd())){p=this.incrementMap(p,k[s]+k[o]);f=this.incrementMap(f,k[s]);_=this.incrementMap(_,k[o]);v[k[s]]=k[m]}}var S=[];Object.keys(f).forEach(e=>{var t={bar:e,arrest_count:f[e]}
;t[m]=v[e]
;S.push(t)});if(


u=="DESC"&&m==s){
S.sort(w)}else if(


u=="ASC"&&m=="Day_of_Week_int"){
S.sort((e,t)=>{
return e[m]-t[m]})}else if(

o=="3YearToDateStatus"){
S.sort((e,t)=>{if(
e=="Year To Date"){
return 1}else{

return-1}})}





var M=[]
;Object.keys(_).forEach(e=>{
M.push(e)})



;M=M.sort((e,t)=>{if(
o=="YearToDateStatus"){if(
e=="Year To Date"){
return 1}else{

return-1}}else{


return _[t]-_[e]}})





;var F=["x"]
;S.forEach(e=>{
F.push(e.bar)})



;var E=[]
;E.push(F)


;Object.keys(M).forEach(e=>{
var i=M[e]
;var r=[i]
;S.forEach(e=>{
var t=e.bar

;var a=p[t+i];if(
a==undefined){
a=0}

r.push(a)})

;E.push(r)})


;y={columns:E,
groups:M}
;r(y)}getTopLists(


e,t,a,i){
var r=[]

;var n={}
;var s={}
;var o={}
;var l={}

;var h=[]
;var d=[]
;var c=[];for(

var m=this.data.length-1;m>=0;m--){
var u=this.data[m];if(
this.dateLimit(u,this.DateRangeControl.getStart(),this.DateRangeControl.getEnd())){
n=this.incrementMap(n,u.Crime_category)
;s=this.incrementMap(s,u.Name)
;o=this.incrementMap(o,u.Position)
;l[u.Position]=u.Position_name}}



Object.keys(n).forEach(e=>{
var t={}
;t["Crime_category"]=e
;t["arrest_count"]=n[e]
;h.push(t)})



;Object.keys(s).forEach(e=>{
var t={}
;t["Name"]=e
;t["arrest_count"]=s[e]
;d.push(t)})



;Object.keys(o).forEach(e=>{
var t={}
;t["Position"]=e
;t["Position_name"]=l[e]
;t["arrest_count"]=o[e]
;c.push(t)})


;var g=function(e,t){
return t.arrest_count-e.arrest_count}



;r.push(h.sort(g).slice(e,e+5))
;r.push(d.sort(g).slice(e,e+5))
;r.push(c.sort(g).slice(e,e+5))

;i(r)}getFilteredDataCount(


e,t){
var a=t||(e=>{return this.dateLimit(e,this.DateRangeControl.getStart(),this.DateRangeControl.getEnd())})
;var i=[]
;this.forEach(e=>{if(
this.dateLimit(e,this.DateRangeControl.getStart(),this.DateRangeControl.getEnd())){if(
a(e)){
i.push(e)}}},()=>{




e(i.length)})}getArrests(



t,e){
var a=[]
;this.forEach(e=>{if(
this.dateLimit(e,this.DateRangeControl.getStart(),this.DateRangeControl.getEnd())){if(
t(e)){
a.push(e)}}},()=>{




e(a)})}}class Utilities{constructor(){this.googleTracking=new GoogleAnalyticsManager}gaEvent(e,t,a,i,r){this.googleTracking.sendTrackEvent(a,i)}setCookieValue(e,t,a){var i=new Date;a=a||.5;i.setTime(i.getTime()+a*24*60*60*1e3);var r="expires="+i.toUTCString();document.cookie=e+"="+t+"; "+r}getCookieValue(e){var t=e+"=";var a=document.cookie.split(";");for(var i=0;i<a.length;i++){var r=a[i];while(r.charAt(0)==" ")r=r.substring(1);if(r.indexOf(t)==0)return r.substring(t.length,r.length)}return""}setupFacebook(){window.fbAsyncInit=function(){FB.init({appId:"563956043742586",xfbml:true,version:"v2.4"});FB.Event.subscribe("edge.create",function(e){this.googleTracking.sendTrackEvent("facebook","like")});FB.Event.subscribe("edge.remove",function(e){this.googleTracking.sendTrackEvent("facebook","unlike")});FB.Event.subscribe("message.send",function(e){this.googleTracking.sendTrackEvent("facebook","send")})};(function(e,t,a){var i,r=e.getElementsByTagName(t)[0];if(e.getElementById(a)){return}i=e.createElement(t);i.id=a;i.src="//connect.facebook.net/en_US/sdk.js";r.parentNode.insertBefore(i,r)})(document,"script","facebook-jssdk")}setupTwitter(){var a=this;window.twttr=function(e,t,a){var i,r=e.getElementsByTagName(t)[0],n=window.twttr||{};if(e.getElementById(a))return n;i=e.createElement(t);i.id=a;i.src="https://platform.twitter.com/widgets.js";r.parentNode.insertBefore(i,r);n._e=[];n.ready=function(e){n._e.push(e)};return n}(document,"script","twitter-wjs");twttr.ready(function(e){e.events.bind("tweet",function(e){if(e){var t=window.location.href;if(e.target&&e.target.nodeName=="IFRAME"){t=a.extractParamFromUri(e.target.src,"url")}this.googleTracking.sendTrackEvent("twitter","tweet")}})})}mobileCheck(){var t=false;(function(e){if(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4)))t=true})(navigator.userAgent||navigator.vendor||window.opera);return t}mobileAndTabletCheck(){var t=false;(function(e){if(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4)))t=true})(navigator.userAgent||navigator.vendor||window.opera);return t}extractParamFromUri(e,t){if(!e){return null}var a=new RegExp("[\\?&#]"+t+"=([^&#]*)");var i=a.exec(e);if(i!=null){return decodeURI(unescape(i[1]))}return null}saveCanvasAsPNG(e){var t=document.getElementById(e);var a=t.toDataURL("image/png").replace("image/png","image/octet-stream");window.location.href=a}update_hash(e){e=e||false;var t=window.location.pathname.split("/");var a=window.location.hash||this.extractParamFromUri(window.location.search,"id")||(t.pop()||t.pop())||"#!ID Not Set";a=decodeURI(a);a=a.replace("#!","");a=a.replace("#","");if(e!==a){$("#pageTitle").append(a)}return a}SetHash(e){window.location.hash=e}}class GoogleAnalyticsManager{constructor(){this.hashervar=window.location.hash||"",this.pagePath=window.location.pathname+this.hashervar;this.loadScript();ga("create","UA-66360026-1","auto");this.ping()}loadScript(){(function(e,t,a,i,r,n,s){e["GoogleAnalyticsObject"]=r;e[r]=e[r]||function(){(e[r].q=e[r].q||[]).push(arguments)},e[r].l=1*new Date;n=t.createElement(a),s=t.getElementsByTagName(a)[0];n.async=1;n.src=i;s.parentNode.insertBefore(n,s)})(window,document,"script","https://www.google-analytics.com/analytics.js","ga")}ping(){ga("send","pageview",this.pagePath)}sendTrackEvent(e,t){if(arguments.length<3){ga("send","event",e,t)}}}var DEBUG=false;class WebPage{constructor(e,t){this.Utilities=new Utilities;this.StyleManager=new StyleSheetManager;this.LoadingBar=new LoadingBarManager;this.pageTitle=e||"Default";this.option_HideLoadingBar=t===true?true:false;this.arrest_view_mode=0;if(this.Utilities.mobileCheck()){this.arrest_view_mode=1;moment.locale("en",{relativeTime:{future:"in %s",past:"%s ago",s:"a few secs",ss:"%d secs",m:"a min",mm:"%d mins",h:"an hr",hh:"%d hrs",d:"a day",dd:"%d day",w:"a wk",ww:"%d wks",M:"a mth",MM:"%d mths",y:"a yr",yy:"%d yrs"}})}if(this.option_HideLoadingBar){this.LoadingBar.hideLoading()}this.charts=[];this.Modules_HashMap={};this.RenderUpdateDate()}renderView(){this.renderModules()}RenderUpdateDate(){var e=lastUpdate.split(",")[0];$("#updateDateFooter").html("Updated: "+e+' <a href="BuildHistory.html">v'+lastVersion+"</a>")}checkLoadingFinished(){console.warn("Default WebPage.js checkLoadingFinished() function called, should be overriden within a subclass");this.loadingFinished()}loadingFinished(){this.LoadingBar.hideLoading();this.Utilities.setupFacebook();this.Utilities.setupTwitter()}setupFilters(){var e=this.pageTitle.toLowerCase();var t={presets:{},date_range_object:this.dateRangeNFL};t["presets"][e]={};t["presets"][e][e]=this.pageID;this.FilterControl=new FiltersControl(t);$(this.FilterControl.options.dialog_element).on("FilterDialogChanged",()=>{this.renderView()})}getModuleCount(){return Object.keys(this.Modules_HashMap).length}getModules(){return this.Modules_HashMap}getModule(e){if(this.Modules_HashMap.hasOwnProperty(e)){return this.Modules_HashMap[e]}else{console.error("No Module with the moduleID: "+e);return false}}setModules(e){if(Object.isObject(mObj)){this.Modules_HashMap=mObj}else{console.warn('WebPage.setModules(mObj): Expected Parameter(mObj) to be of type Object that should be formatted as a HashMap eg: [{"Key": ModuleInstance, "Key2": ModuleInstance2}].')}}addModule(e,t){t=t||"Module_"+e.getModuleID()+"_"+this.getModuleCount();this.Modules_HashMap[t]=e;return t}removeModule(e){if(this.Modules_HashMap[e]){delete this.Modules_HashMap[e]}else{console.warn("No such module found",e)}}renderModules(){if(this.getModuleCount()>0){var e=Object.keys(this.Modules_HashMap);for(var t=0;t<e.length;t++){this.Modules_HashMap[e[t]].renderView()}}}getHTMLDateTitleAttribute(e,t){if(typeof e!=="undefined"){var a=t||"Date";if(e.hasOwnProperty(a)){return'title="'+e[a].split("T")[0]+'"'}else{console.error("WebPage > getHTMLDateTitleAttribute: Row did not contain ["+a+"].");return""}}else{return""}}getDetailPageLink(e,t){return e.charAt(0).toUpperCase()+e.slice(1)+".html#"+t}getCrimeLink(e){return this.getDetailPageLink("CrimeCategory",e)}getCrimeSubCategoryLink(e){return this.getDetailPageLink("Crime",e)}getPlayerLink(e){return this.getDetailPageLink("Player",e)}getTeamLink(e){return this.getDetailPageLink("Team",e)}getPositionLink(e){return this.getDetailPageLink("Position",e)}displayDialogBox(e,t,a,i){var r=e||"error-dialog";var t=t||"Error! No Message found.";var a=a||"Error";var i=i||{modal:true};if($("#"+r).length===0){$("body").append('<div id="'+r+'" title="'+a+'">'+t+"</div>")}$("#"+r).dialog(i);this.Utilities.googleTracking.sendTrackEvent("PageDialogOpen",a)}}class DataDrivenWebPage extends WebPage{constructor(e,t){super(e,t);this.FilterFunction=e=>{return this.data_controller.dateLimit(e,this.DateRangeControl.getStart(),this.DateRangeControl.getEnd())};this.DateRangeControl=new DateRangeControl(this);this.data_controller=new DataController(this.DateRangeControl,this);this.setupEvents()}setupEvents(){$("#dateRangeJquery").on("dateRangeChanged",e=>{this.renderView(this)})}getDataFilters(){return[this.DateRangeControl]}getDataController(){return this.data_controller}setDataController(e){this.data_controller=e}checkForZeroRecords(){var e=e=>{if(e<=0){this.DateRangeControl.setDates(moment("2000-01-01"),moment());this.DateRangeControl.renderView();this.displayDialogBox("error-dialog","<strong>Warning!</strong> No Data Returned with current Filter Selection. Date Filter Set to default.","Date Range Error")}};this.getDataController().getFilteredDataCount(e,this.FilterFunction)}renderView(){this.checkForZeroRecords();this.LoadingBar.showLoading();super.renderView()}}class Chart{constructor(e,t,a){this.chart=undefined;this.parent=a;this.options={targetElement:"#theElementSelector",chartTitle:"default",data:{}};this.defaultColorPattern=["#1F77B4","#FF7F0E","#2CA02C","#D62728","#9467BD","#8C564B","#E377C2","#7F7F7F","#BCBD22","#17BECF","#154F78","#B0580A","#248224","#7D1717"];$.extend(true,this.options,e);this.chartType=t||"donut";this.options.$targetElement=$(this.options.targetElement);this.renderChart()}renderChart(){console.warn("WARNING: Using default render chart");var e={bindto:this.options.targetElement,data:{columns:this.options.data,type:this.chartType},color:{pattern:["#1F77B4","#FF7F0E","#2CA02C","#D62728","#9467BD","#8C564B","#E377C2","#7F7F7F","#BCBD22","#17BECF","#154F78","#B0580A","#248224","#7D1717"]}};if(this.chartType=="donut"){e["donut"]={title:this.options.chartTitle}}this.chart=c3.generate(e)}}var IndexPageInstance;class IndexPage extends DataDrivenWebPage{constructor(){super("Index");this.StyleManager.loadCSS("css/modules/styles-indexpage.css");this.StyleManager.loadCSS("css/vendor/pagination.css");this.MeterOrRecent=Math.random()>.5;this.detail_page_active=true;var e=[DATA_MODEL_DISPLAY_COLUMNS.getColumn("Date",2),DATA_MODEL_DISPLAY_COLUMNS.getColumn("Name",2),DATA_MODEL_DISPLAY_COLUMNS.getColumn("Crime_category",2),DATA_MODEL_DISPLAY_COLUMNS.getColumn("Team",1),DATA_MODEL_DISPLAY_COLUMNS.getColumn("Description",5)];var t={targetElement:"arrest_table",TitlePrefix:"Latest ",RowLimit:5,GoogleTrackingCategory:"IndexPageArrests",columns:e,RenderCardFn:e=>{var t=new ArrestCard(this,e);return t.getHTML(t.Dimension_Crime_Category,t.Dimension_Team,t.Dimension_Player)}};this.DataTable_ModuleID=this.addModule(new DataTable(this,[],t));this.MainChart=new MainChart(this);this.TopLists=new TopLists(this);this.evaluateHash();this.TopLists.fixTopListLinks();$("#loadMoreLists").click(this.TopLists.jQuery_Handler);if(this.detail_page_active){this.data_controller.getTeams(e=>{this.RenderTeamLinks(e)})}else{$("#bottomTeamLinks").hide()}}renderView(){super.renderView();this.MainChart.setupChart();this.TopLists.reload();this.data_controller.getTeams(e=>{this.RenderTeamLinks(e)})}evaluateHash(){if(window.location.hash){if(window.location.hash=="#ByYear"){this.MainChart.setStyleID(1)}else if(window.location.hash=="#BySeason"){this.MainChart.setStyleID(2)}else if(window.location.hash=="#ByDayOfWeek"){this.MainChart.setStyleID(3)}else if(window.location.hash=="#ByDivision"){this.MainChart.setStyleID(4)}else{this.MainChart.setStyleID(0)}}else{this.MainChart.setStyleID(0)}}checkLoadingFinished(){if(typeof this.MainChart!=="undefined"){if(typeof this.TopLists!=="undefined"){if(this.MainChart.getReturnStatus()&&this.TopLists.getReturnStatus()){this.TopLists.setReturnStatus(false);this.MainChart.setReturnStatus(false);this.setupArrestOMeter(this.MeterOrRecent);this.setupRecentArrestCard(!this.MeterOrRecent);this.loadingFinished()}}else{}}else{}}RenderTeamLinks(e){$("#bottomTeamLinks").html("<h4>Teams</h4>");$("#bottomTeamLinks").append('<div id="bottomTeamLinksNFC" class="row"><div id="division_NFC_West" class="three columns"><h5>NFC West</h5></div><div id="division_NFC_North" class="three columns"><h5>NFC North</h5></div><div id="division_NFC_South" class="three columns"><h5>NFC South</h5></div><div id="division_NFC_East" class="three columns"><h5>NFC East</h5></div></div>');$("#bottomTeamLinks").append('<div id="bottomTeamLinksAFC" class="row"><div id="division_AFC_West" class="three columns"><h5>AFC West</h5></div><div id="division_AFC_North" class="three columns"><h5>AFC North</h5></div><div id="division_AFC_South" class="three columns"><h5>AFC South</h5></div><div id="division_AFC_East" class="three columns"><h5>AFC East</h5></div></div>');$.each(e,(e,t)=>{var a="team";var i=t.Team;var r=a.charAt(0).toUpperCase()+a.slice(1)+".html#"+i;var n="#division_"+t.Team_Conference+"_"+t.Team_Division;var s=t.Team_preffered_name;if(this.arrest_view_mode==1){s=t.Team+" "+t.Team_name}$(n).append('<a href="'+r+"\"><span style=\"display:inline-block;width:20px;height:20px;vertical-align: text-bottom;background:url('images/NFLTeamLogos.png') 0px -"+t.Team_logo_id*20+'px;background-size:100%;"></span> '+s+" <b>"+t.Team_Arrest_Count+"</b></a> ")})}setupArrestOMeter(n){var s=true;this.data_controller.getArrestMeter(function(e){var t=e["current"]["daysSince"],a=e["alltime"]["record"],i=e["alltime"]["average"],r=parseInt(t)/a;$("#arrest_meter_text").html("It has been <b>"+t+"</b> Days since the last arrest.</p>");$("#arrest_meter_subtext").html("Average: <b>"+i+"</b> Days | Record W/O arrest: <b>"+a+"</b> Days");$(".recordHolder").html(a);$(".avgRecord").html(i).css({left:parseInt(i)/parseInt(a)*100+"%"});if(s){$(".meter-fg").animate({width:r*100+"%"},1750)}else{$(".meter-fg").width(r*100+"%")}if(!n){$("#arrest-meter").hide()}else{ga("set","dimension1","Recent")}})}setupRecentArrestCard(e){this.data_controller.getMostRecentArrest(e=>{if(e!==undefined){var t=new ArrestCard(this,e,{standalone:true});$("#mostRecentArrestCard").html(t.getHTML(t.Dimension_Crime_Category,t.Dimension_Team,t.Dimension_Player))}});if(!e){$("#recent-arrest-card").hide()}else{ga("set","dimension1","ArrestOMeter")}}}$(window).load(function(){IndexPageInstance=new IndexPage});var DATA_MODEL_DISPLAY_COLUMNS={Date:{column_id:0,column_title:"Date:",column_data:"Date",column_display_fn:e=>{return moment(e["Date"],"YYYY-MM-DD").fromNow()},column_tooltip:"Date",column_width:2},Name:{column_id:1,column_title:"Player:",column_data:"Name",column_display_fn:e=>{return'<a href="Player.html#'+e["Name"]+'">'+e["Name"]+"</a>"},column_width:2},Category:{column_id:2,column_title:"Crime Sub-Category:",column_data:"Category",column_display_fn:e=>{return'<a href="Crime.html#'+e["Category"]+'">'+e["Category"]+"</a>"},column_width:2},Team:{column_id:3,column_title:"Team:",column_data:"Team",column_display_fn:e=>{return'<a href="Team.html#'+e["Team"]+"\"><span style=\"display:inline-block;width:20px;height:20px;vertical-align: text-bottom;background:url('images/NFLTeamLogos.png') 0px -"+e["Team_logo_id"]*20+'px;background-size:100%;"></span> '+e["Team"]+"</a>"},column_width:1},Description:{column_id:4,column_title:"Description:",column_data:"Description",column_width:5},Outcome:{column_id:5,column_title:"Outcome:",column_data:"Outcome",column_width:4},Crime_category:{column_id:6,column_title:"Crime Category:",column_data:"Crime_category",column_display_fn:e=>{return'<a href="CrimeCategory.html#'+e["Crime_category"]+'">'+e["Crime_category"]+"</a>"},column_width:2},getColumn:(e,t)=>{var a=DATA_MODEL_DISPLAY_COLUMNS[e];if(t!==undefined){a.column_width=t}return a}};class TopLists{constructor(e){this.parent=e;this.last_start_pos=0;this.ReturnStatus=false;this.load_lists("first")}jQuery_Handler(e){IndexPageInstance.TopLists.load_lists("not first",false)}load_list(e,n,s,t,o,a){a=a||false;if(a){this.last_start_pos=0}var l=[];if(e.length>0){$.each(e,(e,t)=>{var a='<a href="'+this.parent.getDetailPageLink(n,t[o[0]])+'">';var i="</a>";if(n==""||!this.parent.detail_page_active){a="";i=""}var r=t[o[0]];if(o.length>2){r=t[o[2]]}l.push("<li id='"+s+e+"'>"+a+"<span>"+r+"</span><span class='value-cell'>"+t[o[1]]+"</span>"+i+"</li>")})}else{if(a){l.push('<li class="list-no-data-msg-item">No Data Available for this Date Range</li>')}}if(a){$(t).html(l.join(""))}else{$(t).append(l.join(""))}}load_lists(e,r){e=e||"not first";r=r||false;$(".list-no-data-msg-item").remove();if(e!="first"){this.parent.Utilities.googleTracking.sendTrackEvent("TopLists","Load Next Page")}this.parent.data_controller.getTopLists(this.last_start_pos,this.parent.DateRangeControl.getStart(),this.parent.DateRangeControl.getEnd(),e=>{var t=e[0],a=e[1],i=e[2];if(t.length+a.length+i.length<=0&&this.last_start_pos==0){console.warn("no data returned")}this.load_list(t,"CrimeCategory","top_crime_","#top_crimes_list",["Crime_category","arrest_count"],r);this.load_list(a,"player","top_player_","#top_players_list",["Name","arrest_count"],r);this.load_list(i,"position","top_pos_","#top_positions_list",["Position","arrest_count","Position_name"],r);this.setReturnStatus(true);this.last_start_pos=this.last_start_pos+5;this.parent.checkLoadingFinished()})}reload(){this.last_start_pos=0;this.load_lists("not first",true)}fixTopListLinks(){if(this.parent.detail_page_active){$(".top-list ol li").click(function(){window.location=$(this).find("a").attr("href");return false})}}getReturnStatus(){return this.ReturnStatus}setReturnStatus(e){this.ReturnStatus=e}}class MainChart{constructor(e){this.parent=e;this.ReturnStatus=false;this.ytdChart=false;this.StyleID=0;this.buttons=[{title:"By Team",short_title:"ByTeam",id:0,ytdChart:false,element:"#mainChartByTeamBtn"},{title:"By Year",short_title:"ByYear",id:1,ytdChart:true,element:"#mainChartByYearBtn"},{title:"By Season",short_title:"BySeason",id:2,ytdChart:false,element:"#mainChartBySeasonBtn"},{title:"By Day",short_title:"ByDayOfWeek",id:3,ytdChart:false,element:"#mainChartByConfBtn"},{title:"By Division",short_title:"ByDivision",id:4,ytdChart:false,element:"#mainChartByConfDivBtn"}];this.addChartButtonListeners();this.changeTopChart()}setMainChartHandler(e){IndexPageInstance.MainChart.setMainChart(e.data.btn)}setMainChart(e){this.ytdChart=e.ytdChart;this.StyleID=e.id;this.parent.Utilities.SetHash(e.short_title);this.changeTopChart();this.parent.Utilities.googleTracking.sendTrackEvent("mainChart","switchTo"+e.short_title)}addChartButtonListeners(){for(var e=0;e<this.buttons.length;e++){$(this.buttons[e].element).click({btnID:e,btn:this.buttons[e]},this.setMainChartHandler)}}changeTopChart(){this.setupChart();this.changeChartButtonStyle()}changeChartButtonStyle(){if(this.StyleID==1){$(".mainChartBtn").removeClass("button-primary");$("#mainChartByYearBtn").addClass("button-primary")}else if(this.StyleID==0){$(".mainChartBtn").removeClass("button-primary");$("#mainChartByTeamBtn").addClass("button-primary")}else if(this.StyleID==2){$(".mainChartBtn").removeClass("button-primary");$("#mainChartBySeasonBtn").addClass("button-primary")}else if(this.StyleID==3){$(".mainChartBtn").removeClass("button-primary");$("#mainChartByConfBtn").addClass("button-primary")}else if(this.StyleID==4){$(".mainChartBtn").removeClass("button-primary");$("#mainChartByConfDivBtn").addClass("button-primary")}}destroyChart(){if(this.parent.charts.length>0)if(typeof this.parent.charts[0]!="undefined")if(this.parent.charts[0].hasOwnProperty("stackedChart"))if(typeof this.parent.charts[0].stackedChart!="undefined")this.parent.charts[0].stackedChart.destroy()}setupChart(){this.destroyChart();var e=e=>{var t={data:e,targetElement:"#chart",targetExpandBtn:"#details_summary_btn",hideBtn:"#hideAll_btn",showBtn:"#showAll_btn"};this.parent.charts[0]=new StackedBarChart(t,this);this.setReturnStatus(true);this.parent.checkLoadingFinished()};this.getOverallChartData(e)}getOverallChartData(e){if(this.StyleID==0){this.parent.data_controller.getOverallChart("Crime","Team Code","Team Code","DESC",e)}else if(this.StyleID==1){this.parent.data_controller.getOverallChart("YearToDate","Year","Year","ASC",e)}else if(this.StyleID==3){this.parent.data_controller.getOverallChart("Crime","Day","DayOrder","ASC",e)}else if(this.StyleID==2){this.parent.data_controller.getOverallChart("SeasonState","Season","Season","ASC",e)}else if(this.StyleID==4){this.parent.data_controller.getOverallChart("Crime","Division","Division","ASC",e)}}setYTD(e){this.ytdChart=e}getYTD(){return this.ytdChart}setStyleID(e){this.StyleID=e;this.changeTopChart()}getStyleID(){return this.StyleID}setReturnStatus(e){this.ReturnStatus=e}getReturnStatus(){return this.ReturnStatus}}class StackedBarChart extends Chart{constructor(e,t){super(e,"bar",t);this.isFirstHover=true;this.options.$targetElement=$(this.options.targetElement);this.renderChart()}getBottomPadding(){var e=0;if($(document).width()<800){e=20}else{e=6}return e}renderCustomLegend(){$(".customLegend").remove();d3.select(".chart-container").insert("div",".chart-options").attr("class","customLegend").selectAll("span").data(this.options.data.groups).enter().append("span").attr("data-id",function(e){return e}).attr("class",function(e){var t=e.replace("/","");t=t.split(" ").join("");return"customLegend-item customLegend-item-"+t}).html(function(e){return'<span class="customLegend-item-color" style="background-color:'+this.chart.color(e)+';"></span> '+e}).on("mouseover",function(e){this.chart.focus(e);if(this.isFirstHover){this.isFirstHover=false;this.parent.Utilities.googleTracking.sendTrackEvent("mainChart","legendMouseover")}}).on("mouseout",function(e){this.chart.revert()}).on("click",e=>{this.chart.toggle(e);var t=e.replace("/","");t=t.split(" ").join("");var a=d3.select(".customLegend-item-"+t);a.classed("transparent",!a.classed("transparent"));this.parent.Utilities.googleTracking.sendTrackEvent("mainChart","legendClick")})}renderChart(){var e=this.getBottomPadding();var t={bindto:this.options.targetElement,data:{empty:{label:{text:"No Data Available for this Date Range"}},x:"x",columns:this.options.data.columns,groups:[this.options.data.groups],order:"asc",type:"bar",onclick:(e,t)=>{if(typeof this.parent.MainChart.StyleID!="undefined"){if(this.parent.MainChart.StyleID==0&&this.parent.detail_page_active){this.parent.Utilities.googleTracking.sendTrackEvent("mainChart","teamLink");setTimeout(()=>{window.location.href="Team.html#"+this.options.data.columns[0][e["index"]+1]},100)}}}},zoom:{enabled:this.options.zoomEnabled},padding:{bottom:e},legend:{show:!this.options.customLegend},axis:{x:{type:"category"}},tooltip:{contents:function(e,t,a,i){var r=this,n=r.config,s=n.tooltip_format_title||t,o=n.tooltip_format_name||function(e){return e},l,h,d,c,m,u;e=e.sort(function(e,t){if(e.value>=t.value){if(e.value==t.value){return 0}else{return-1}}else{return 1}});for(h=0;h<e.length;h++){if(!(e[h]&&(e[h].value||e[h].value===0))){continue}if(e[h].value=="0"||e[h].value==0){continue}if(!l){d=s?s(e[h].x,e[h].index):e[h].x;l="<table class='"+r.CLASS.tooltip+"'>"+(d||d===0?"<tr><th colspan='2'>"+d+"</th></tr>":"")}c=a(e[h].value,e[h].ratio,e[h].id,e[h].index,e);if(c!==undefined){if(e[h].name===null){continue}m=o(e[h].name,e[h].ratio,e[h].id,e[h].index);u=i(e[h].id)}if(c!==undefined){l+="<tr class='"+r.CLASS.tooltipName+"-"+r.getTargetSelectorSuffix(e[h].id)+"'>";l+="<td class='name'><span style='background-color:"+u+"'></span>"+m+"</td>";l+="<td class='value'>"+c+"</td>";l+="</tr>"}}return l+"</table>"}},color:{pattern:["#1F77B4","#FF7F0E","#2CA02C","#D62728","#9467BD","#8C564B","#E377C2","#7F7F7F","#BCBD22","#17BECF","#154F78","#B0580A","#248224","#7D1717"]}};this.chart=c3.generate(t);if(this.options.customLegend){this.renderCustomLegend()}}}class DateRangeControl{constructor(e){this.start_date="2000-01-01";this.end_date="";this.parent=e;this.setHash();this.setupDateRangePicker();this.setupDateRangePickerEvents()}setupDateRangePicker(e){var e=e||[{text:"Last 3 Months",dateStart:()=>moment().subtract("months",3),dateEnd:()=>moment()},{text:"Last 6 Months",dateStart:()=>moment().subtract("months",6),dateEnd:()=>moment()},{text:"Last Year",dateStart:()=>moment().subtract("years",1),dateEnd:()=>moment()},{text:"Last 5 Years",dateStart:()=>moment().subtract("years",5),dateEnd:()=>moment()},{text:"All Records",dateStart:()=>moment("2000-01-01"),dateEnd:()=>moment()}];var t=this.parent.Utilities.mobileCheck()?1:2;$("#dateRangeJquery").daterangepicker({presetRanges:e,datepickerOptions:{minDate:new Date("2000-01-01"),maxDate:0,numberOfMonths:t}})}renderView(){this.setDefaultDate();var e={start:moment(this.start_date).toDate(),end:moment(this.end_date).toDate()};$("#dateRangeJquery").daterangepicker("setRange",e)}setupDateRangePickerEvents(){this.renderView();$("#dateRangeJquery").on("change",()=>{this.changeDateRange(this)});$("#dateRangeJquery").on("open",()=>this.parent.Utilities.googleTracking.sendTrackEvent("DateRange","OpenDialog"))}open(){$("#dateRangeJquery").daterangepicker("open")}close(){$("#dateRangeJquery").daterangepicker("close")}resetTime(e){this.parent.Utilities.googleTracking.sendTrackEvent("DateRange","Reset");e=e||false;var t="2000-01-01",a=this.getToday();this.setDates(t,a)}setDefaultDate(){var e=moment().format("YYYY-MM-DD");this.start_date=this.start_date||this.getCookie("start_date")||"2000-01-01";this.end_date=this.end_date||this.getCookie("end_date")||e}getToday(){var e=new Date,t,a;if(e.getMonth()<9){t="0"+(e.getMonth()+1)}else{t=e.getMonth()+1}if(e.getDate()<10){a="0"+e.getDate()}else{a=e.getDate()}return e.getFullYear()+"-"+t+"-"+a}getStart(){return this.start_date}getEnd(){return this.end_date}setHash(){if(typeof pageID!=="undefined"){var e=pageID||"";e="#!"+e}else{var e="#!"}}changeDateRange(e){var t=JSON.parse($("#dateRangeJquery").val());var a=t.start,i=t.end;if(new Date(a)>new Date(i)){var r=a;a=i;i=r}e.setDates(a,i)}setDates(e,t){this.setCookie("start_date",e);this.setCookie("end_date",t);this.start_date=e;this.end_date=t;if(window.CustomEvent){var a=new Event("dateRangeChanged");$("#dateRangeJquery").trigger("dateRangeChanged");this.parent.Utilities.googleTracking.sendTrackEvent("DateRange","DateChanged")}}setCookie(e,t,a){return this.parent.Utilities.setCookieValue(e,t,a)}getCookie(e){return this.parent.Utilities.getCookieValue(e)}}class StyleSheetManager{constructor(){this.stylesheets=["css/styles.min.css","css/vendor/normalize.min.css","css/vendor/skeleton.min.css","css/vendor/c3.css","css/vendor/jquery-ui.min.css","css/vendor/jquery.comiseo.daterangepicker.css"];this.loadStylesheets()}loadCSS(r){(function(e,t){var a=e.createElement(t),i=e.getElementsByTagName(t)[0];a.href=r;a.rel="stylesheet";i.parentNode.insertBefore(a,i)})(document,"LINK");return true}loadStylesheets(e){var t=e||(this.stylesheets||[]);var a=true;for(var i=0;i<t.length;i++){a=this.loadCSS(t[i])}return a}}var StyleSheetManagerInstance=new StyleSheetManager;