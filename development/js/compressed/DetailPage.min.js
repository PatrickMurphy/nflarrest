







var DEBUG=false

;class WebPage{constructor(
e,t){
this.Utilities=new Utilities
;this.StyleManager=new StyleSheetManager
;this.LoadingBar=new LoadingBarManager

;this.pageTitle=e||"Default"
;this.option_HideLoadingBar=t===true?true:false

;this.arrest_view_mode=0;if(

this.Utilities.mobileCheck()){
this.arrest_view_mode=1
;moment.locale("en",{relativeTime:{

future:"in %s",
past:"%s ago",
s:"a few secs",
ss:"%d secs",
m:"a min",
mm:"%d mins",
h:"an hr",
hh:"%d hrs",
d:"a day",
dd:"%d day",
w:"a wk",
ww:"%d wks",
M:"a mth",
MM:"%d mths",
y:"a yr",
yy:"%d yrs"}})}if(





this.option_HideLoadingBar){
this.LoadingBar.hideLoading()}



this.charts=[]
;this.Modules_HashMap={}


;this.RenderUpdateDate()}renderView(){



this.renderModules()}RenderUpdateDate(){




var e=lastUpdate.split(",")[0]

;$("#updateDateFooter").html("Updated: "+e+' <a href="BuildHistory.html">v'+lastVersion+"</a>")}checkLoadingFinished(){




console.warn("Default WebPage.js checkLoadingFinished() function called, should be overriden within a subclass")

;this.loadingFinished()}loadingFinished(){



this.LoadingBar.hideLoading()


;this.Utilities.setupFacebook()
;this.Utilities.setupTwitter()}getModuleCount(){




return Object.keys(this.Modules_HashMap).length}getModules(){



return this.Modules_HashMap}getModule(


e){if(
this.Modules_HashMap.hasOwnProperty(e)){
return this.Modules_HashMap[e]}else{

console.error("No Module with the moduleID: "+e)
;return false}}setModules(



e){if(
Object.isObject(mObj)){
this.Modules_HashMap=mObj}else{

console.warn('WebPage.setModules(mObj): Expected Parameter(mObj) to be of type Object that should be formatted as a HashMap eg: [{"Key": ModuleInstance, "Key2": ModuleInstance2}].')}}addModule(



e,t){
t=t||"Module_"+e.getModuleID()+"_"+this.getModuleCount()
;this.Modules_HashMap[t]=e
;return t}removeModule(


e){if(
this.Modules_HashMap[e]){
delete this.Modules_HashMap[e]}else{

console.warn("No such module found",e)}}renderModules(){if(




this.getModuleCount()>0){
var e=Object.keys(this.Modules_HashMap);for(
var t=0;t<e.length;t++){
this.Modules_HashMap[e[t]].renderView()}}}getHTMLDateTitleAttribute(






e,t){if(
typeof e!=="undefined"){
var a=t||"Date";if(
e.hasOwnProperty(a)){
return'title="'+e[a].split("T")[0]+'"'}else{

console.error("WebPage > getHTMLDateTitleAttribute: Row did not contain ["+a+"].")
;return""}}else{


return""}}getDetailPageLink(




e,t){
return e.charAt(0).toUpperCase()+e.slice(1)+".html#"+t}getCrimeLink(


e){
return this.getDetailPageLink("CrimeCategory",e)}getCrimeSubCategoryLink(


e){
return this.getDetailPageLink("Crime",e)}getPlayerLink(


e){
return this.getDetailPageLink("Player",e)}getTeamLink(


e){
return this.getDetailPageLink("Team",e)}getPositionLink(


e){
return this.getDetailPageLink("Position",e)}displayDialogBox(


e,t,a,i){
var r=e||"error-dialog"
;var t=t||"Error! No Message found."
;var a=a||"Error"
;var i=i||{modal:true};if(


$("#"+r).length===0){
$("body").append('<div id="'+r+'" title="'+a+'">'+t+"</div>")}

$("#"+r).dialog(i)
;this.Utilities.googleTracking.sendTrackEvent("PageDialogOpen",a)}}var DATA_MODEL_FRAMEWORK_MONTHS_VALUES_ARRAY=[{COLUMN_NAME:"months",COLUMN_VALUE:1,COLUMN_DISPLAY_VALUE:"January"},{COLUMN_NAME:"months",COLUMN_VALUE:2,COLUMN_DISPLAY_VALUE:"February"},{COLUMN_NAME:"months",COLUMN_VALUE:3,COLUMN_DISPLAY_VALUE:"March"},{COLUMN_NAME:"months",COLUMN_VALUE:4,COLUMN_DISPLAY_VALUE:"April"},{COLUMN_NAME:"months",COLUMN_VALUE:5,COLUMN_DISPLAY_VALUE:"May"},{COLUMN_NAME:"months",COLUMN_VALUE:6,COLUMN_DISPLAY_VALUE:"June"},{COLUMN_NAME:"months",COLUMN_VALUE:7,COLUMN_DISPLAY_VALUE:"July"},{COLUMN_NAME:"months",COLUMN_VALUE:8,COLUMN_DISPLAY_VALUE:"August"},{COLUMN_NAME:"months",COLUMN_VALUE:9,COLUMN_DISPLAY_VALUE:"September"},{COLUMN_NAME:"months",COLUMN_VALUE:10,COLUMN_DISPLAY_VALUE:"October"},{COLUMN_NAME:"months",COLUMN_VALUE:11,COLUMN_DISPLAY_VALUE:"November"},{COLUMN_NAME:"months",COLUMN_VALUE:12,COLUMN_DISPLAY_VALUE:"December"}];var DATA_MODEL_FRAMEWORK_DAY_OF_WEEK_VALUES_ARRAY=[{COLUMN_NAME:"day_of_week",COLUMN_VALUE:1,COLUMN_DISPLAY_VALUE:"Monday"},{COLUMN_NAME:"day_of_week",COLUMN_VALUE:2,COLUMN_DISPLAY_VALUE:"Tuesday"},{COLUMN_NAME:"day_of_week",COLUMN_VALUE:3,COLUMN_DISPLAY_VALUE:"Wednesday"},{COLUMN_NAME:"day_of_week",COLUMN_VALUE:4,COLUMN_DISPLAY_VALUE:"Thursday"},{COLUMN_NAME:"day_of_week",COLUMN_VALUE:5,COLUMN_DISPLAY_VALUE:"Friday"},{COLUMN_NAME:"day_of_week",COLUMN_VALUE:6,COLUMN_DISPLAY_VALUE:"Saturday"},{COLUMN_NAME:"day_of_week",COLUMN_VALUE:7,COLUMN_DISPLAY_VALUE:"Sunday"}];var DATA_MODEL_FRAMEWORK_BOOLEAN_VALUES_ARRAY=[{COLUMN_NAME:"boolean",COLUMN_VALUE:0,COLUMN_DISPLAY_VALUE:"No"},{COLUMN_NAME:"boolean",COLUMN_VALUE:1,COLUMN_DISPLAY_VALUE:"Yes"}];var DATA_MODEL_FRAMEWORK_NULLABLE_BOOLEAN_VALUES_ARRAY=[{COLUMN_NAME:"boolean",COLUMN_VALUE:0,COLUMN_DISPLAY_VALUE:"No"},{COLUMN_NAME:"boolean",COLUMN_VALUE:1,COLUMN_DISPLAY_VALUE:"Yes"},{COLUMN_NAME:"boolean",COLUMN_VALUE:2,COLUMN_DISPLAY_VALUE:"Either"}];class DetailPage extends DataDrivenWebPage{constructor(e,t,a,i){super(e);this.arrestsUrl=i||"empty url";a=a===undefined?false:a;this.pageID=this.Utilities.update_hash();this.pageTitle=e;this.chartOptions=t;this.tableOptions=a;this.callbackReturns=0;this.arrest_data_all=[];this.data_row_count=0;var r=this;this.FilterFunction=e=>{if(!this.data_controller.dateLimit(e,this.DateRangeControl.getStart(),this.DateRangeControl.getEnd())){return false}if(r.pageTitle=="Team"){if(e["Team"]!=r.pageID){return false}}else if(r.pageTitle=="Position"){if(e["Position"]!=r.pageID){return false}}else if(r.pageTitle=="Player"){if(e["Name"]!=r.pageID){return false}}else if(r.pageTitle=="Crime"){if(e["Category"]!=r.pageID){return false}}else if(r.pageTitle=="Crime Category"){if(e["Crime_category"]!=r.pageID){return false}}return true};this.StyleManager.loadCSS("css/modules/styles-detailpage.css");this.StyleManager.loadCSS("css/vendor/pagination.css");if(a){this.DataTable_ModuleID=this.addModule(new DataTable(this,[],a))}else{this.DataTable_ModuleID=this.addModule(new DataTable(this))}$(window).on("hashchange",()=>{this.renderView(this)});setTimeout(()=>{this.resizeCharts()},1e3);this.renderView(this)}checkLoadingFinished(){var e=1+this.chartOptions.length;if(++this.callbackReturns==e){this.callbackReturns=0;this.loadingFinished()}}renderView(e){super.renderView();e.pageID=this.Utilities.update_hash(e.pageID);e.changeTitle();e.setupCharts();e.resizeCharts();e.hideChartsIfRowCountLow()}hideChartsIfRowCountLow(){this.hideCharts(()=>{var e=this.arrest_view_mode==0?3:6;var t=this.getModule(this.DataTable_ModuleID).getData().length;return t<=e},"aside")}hideCharts(e,t){if(e()){$(t).hide()}}changeTitle(e,t,a){var i=t||this;a=a||"";document.title="NFL Arrest | "+e+" | List of Player Arrests";$("#pageTitle").html(i.pageTitle+": "+e+a)}resizeCharts(){for(var e=0;e<this.charts.length;e++){this.charts[e].chart.resize()}}setupCharts(){var a=this;for(var e in a.chartOptions){var t=a.chartOptions[e];a.getDonutData(t.url+a.pageID,t.field,e,(e,t)=>{a.charts.push(new DonutChart({data:e,targetElement:a.chartOptions[t].targetElement,chartTitle:a.chartOptions[t].title},a))})}}getDonutData(e,n,o,l){var h=this;var t=e=>{h.data_row_count+=e.length;var t=[];var a,i=0;var r=["Other",0];var s=12;for(a in e){if(++i<s){t.push([e[a][n],e[a]["arrest_count"]])}else{r[1]=parseInt(r[1])+parseInt(e[a]["arrest_count"])}}if(e.length>=s){t.push(r)}h.checkLoadingFinished();l(t,o)};h.data_controller.getDonutChart(n,this.FilterFunction,t)}}class DonutChart extends Chart{constructor(e,t){super(e,"donut",t);this.renderChart()}renderChart(){var e={bindto:this.options.targetElement,data:{columns:this.options.data,type:this.chartType},donut:{title:this.options.chartTitle},color:{pattern:this.defaultColorPattern}};this.chart=c3.generate(e)}}var timeSeriesChart={timeChart:undefined,options:{targetElement:"#theElementSelector",compareToBtn:"#btnSelector",initColumnID:"",data:{},isExpanded:false,showAccumulation:false,ajaxURL:"/api/"},init:function(e,t){$.extend(true,this.options,e);this.parent=t;var a=this;a.options.$targetElement=$(this.options.targetElement);a.options.$expandBtnElement=$(this.options.targetExpandBtn);timeSeriesChart.options.$expandBtnElement.off("click");timeSeriesChart.options.$expandBtnElement.click(function(){a.toggleExpand(a)});a.renderChart()},renderChart:function(){if($(document).width()<800){var e=20}else{var e=6}timeSeriesChart.timeChart=c3.generate({bindto:timeSeriesChart.options.targetElement,data:{x:"x",columns:[timeSeriesChart.getXDates(),timeSeriesChart.fillDates(timeSeriesChart.options.initColumnID,timeSeriesChart.options.data)]},axis:{x:{type:"timeseries",tick:{format:"%m/%y"}}},padding:{bottom:e},color:{pattern:["#1F77B4","#FF7F0E","#2CA02C","#D62728","#9467BD","#8C564B","#E377C2","#7F7F7F","#BCBD22","#17BECF","#154F78","#B0580A","#248224","#7D1717"]}})},buildAjaxURL:function(e,t){t=t||{};var a={id:e,start_date:dateRangeController.getStart(),end_date:dateRangeController.getEnd()};$.extend(a,t);if(timeSeriesChart.options.ajaxURL.indexOf("?")<0){var i="?"}else{var i="&"}for(var r in a){i+=r+"="+a[r]+"&"}i=i.substring(0,i.length-1);return timeSeriesChart.options.ajaxURL+i},addColumn:function(i){this.parent.Utilities.googleTracking.sendTrackEvent("TimeChart","addCompare "+i);var e=timeSeriesChart.buildAjaxURL(i);$.getJSON(e,function(e){var t=timeSeriesChart.fillDates(i,e),a=t[0];timeSeriesChart.timeChart.load({columns:[t]})})},fillDates:function(e,t){e=e||"";t=t||[];t=t.reverse();var a=new Date(dateRangeController.getStart()),i=new Date(dateRangeController.getEnd()),r=(i.getFullYear()-a.getFullYear())*12+(i.getMonth()-a.getMonth())+1;var s=a.getFullYear(),n=a.getMonth()+1;var o,l=[e.toString()],h=0;var d=t.pop();for(o=r;o>0;o--){if(d!==undefined){n++;if(n>12){s++;n=n%12}if(d.Year==s.toString()&&d.Month==n.toString()){var L;if(timeSeriesChart.options.showAccumulation){h=h+parseInt(d.arrest_count);L=h}else{L=parseInt(d.arrest_count)}l.push(L);if(t.length>0){d=t.pop()}}else{var u;if(timeSeriesChart.options.showAccumulation){u=h}else{u=0}l.push(u)}}else{l.push(0)}}return l},getXDates:function(){var e=["x"];var t=new Date(dateRangeController.getStart()),a=new Date(dateRangeController.getEnd()),i=(a.getFullYear()-t.getFullYear())*12+(a.getMonth()-t.getMonth())+1;var r=t.getFullYear(),s=t.getMonth()+1;var n;for(n=i-1;n>0;n--){s++;if(s>12){r++;s=s%12}if(s<10){var o="0"+s}else{var o=s}e.push(r+"-"+o+"-01")}return e},toggleExpand:function(e){timeSeriesChart.options.$targetElement.toggleClass("expanded");timeSeriesChart.options.isExpanded=!timeSeriesChart.options.isExpanded;if(


timeSeriesChart.options.isExpanded){
timeSeriesChart.options.$expandBtnElement.html("Collapse")}else{

timeSeriesChart.options.$expandBtnElement.html("Expand")}


this.parent.Utilities.googleTracking.sendTrackEvent("mainChart","expand toggle")

;timeSeriesChart.renderChart()}};