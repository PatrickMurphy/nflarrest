var DEBUG=!1;class DetailPage{constructor(e,t,a,n){this.pageID=e,this.pageTitle=t,this.arrestsUrl=n,this.chartOptions=a,this.arrest_view_mode=0,this.data_controller,this.callbackReturns=0,this.charts=[];var i=this;mobileCheck()&&(this.arrest_view_mode=1),loadCSS("css/modules/styles-detailpage.css"),$("body").append('<div id="loading-bar">Loading...</div>'),$("#loading-bar").fadeIn(),$(window).on("hashchange",function(){i.renderView()}),dateRangeController.init(function(e){i.dateRangeNFL=e,DataController.init(i.dateRangeNFL,function(e){i.data_controller=e;var t=i.pageTitle.toLowerCase(),e={presets:{},date_range_object:i.dateRangeNFL};e.presets[t]={},e.presets[t][t]=i.pageID,i.FilterControl=new FiltersControl(e),$(i.FilterControl.options.dialog_element).on("FilterDialogChanged",function(){console.log("render view filter"),i.renderView()}),$("#dateRangeJquery").on("dateRangeChanged",function(e){i.renderView()}),setTimeout(()=>{i.resizeCharts()},1500),i.renderView()})})}getLink(e,t){return e+".html#"+t}getCrimeLink(e){return this.getLink("Crime",e)}getPlayerLink(e){return this.getLink("Player",e)}getTeamLink(e){return this.getLink("Team",e)}getPositionLink(e){return this.getLink("Position",e)}changeTitle(e,t){t=t||this;document.title="NFL Arrest | "+e+" | List of Player Arrests",$("#pageTitle").html(t.pageTitle+": "+e)}renderView(){$("#loading-bar").fadeIn(),this.pageID=update_hash(this.pageID),this.changeTitle(),this.setupCharts(),this.renderArrests(),this.resizeCharts()}resizeCharts(){for(var e=0;e<this.charts.length;e++)this.charts[e].chart.resize()}checkLoadingFinished(){++this.callbackReturns==1+this.chartOptions.length&&(this.callbackReturns=0,$("#loading-bar").fadeOut(),setupFacebook(),setupTwitter())}renderArrests(){var i=this;i.data_controller.getArrests(function(e){if("Team"==i.pageTitle){if(e.Team!=i.pageID)return!1}else if("Position"==i.pageTitle){if(e.Position!=i.pageID)return!1}else if("Player"==i.pageTitle){if(e.Name!=i.pageID)return!1}else if("Crime"==i.pageTitle&&e.Category!=i.pageID)return!1;return!0},function(e){var t,a,n=[];for(a in $("body > div.container > section > div > h4").html(e.length+" Incidents:"),0==i.arrest_view_mode&&n.push(i.renderArrestRowHeader()),e)t=e[a],0==i.arrest_view_mode?n.push(i.renderArrestRow(t)):1==i.arrest_view_mode&&n.push(i.renderArrestCard(t));$("#arrest_table").html(n.join("")),i.checkLoadingFinished()})}renderArrestRowHeader(){return'<tr><th class="one column">Date:</th><th class="one column">Team:</th><th class="two columns">Name:</th><th class="one column">Crime:</th><th class="four columns">Description:</th><th class="three columns">Outcome:</th></tr>'}renderArrestRow(e){var t="<tr>";return t+='<td class="one column">'+moment(e.Date,"YYYY-MM-DD").fromNow()+"</td>",t+='<td class="one column">'+e.Team+"</td>",t+='<td class="two columns"><a href="Player.html#'+e.Name+'">'+e.Name+"</a></td>",t+='<td class="one column"><a href="Crime.html#'+e.Category+'">'+e.Category+"</a></td>",t+='<td class="four columns">'+e.Description+"</td>",t+='<td class="three columns">'+e.Outcome+"</td>",t+="</tr>"}renderArrestCard(e){return new ArrestCard(e).getHTML()}getDonutData(e,r,o,s){var l=this;l.data_controller.getDonutChart(r,function(e){if("Team"==l.pageTitle){if(e.Team!=l.pageID)return!1}else if("Position"==l.pageTitle){if(e.Position!=l.pageID)return!1}else if("Player"==l.pageTitle){if(e.Name!=l.pageID)return!1}else if("Crime"==l.pageTitle&&e.Category!=l.pageID)return!1;return!0},function(e){var t,a=[],n=0,i=["Other",0];for(t in e)++n<12?a.push([e[t][r],e[t].arrest_count]):i[1]=parseInt(i[1])+parseInt(e[t].arrest_count);a.push(i),l.checkLoadingFinished(),s(a,o)})}setupCharts(){var e,a=this;for(e in a.chartOptions){var t=a.chartOptions[e];a.getDonutData(t.url+a.pageID,t.field,e,function(e,t){a.charts.push(new DonutChart({data:e,targetElement:a.chartOptions[t].targetElement,chartTitle:a.chartOptions[t].title}))})}}}class FiltersModel{constructor(){this.filter_types={date_range_controller:{name:"dateRangeController",names:["start_date","end_date"],library:"NFLArrest",description:"The NFL Date Range Controller Module, contains two values",default_val:["2000-01-01",dateRangeController.getToday()],getValue:function(e,t){var a=[];return a.push(e.dateRangeNFL.start_date),a.push(e.dateRangeNFL.end_date),a},isActive:function(e,t){var a=e.dateRangeNFL.start_date!=t.type.default_val[0],t=e.dateRangeNFL.end_date!=t.type.default_val[1];return a||t}},select:{name:"select",library:"Chosen",description:"multi select field for filters, contains an array of values",default_val:null,getValue:function(e,t){return $(t.element).val()},isActive:function(e,t){return $(t.element).val()!=t.type.default_val}},checkbox_group:{name:"checkbox-group",library:"JQuery-UI",description:"a group of binary options",default_val:"all",getValue:function(e,t){var a=[];return $(t.element).map(function(e,t){$(t).prop("checked")?a.push("0"):a.push("1")}),a.join("")},isActive:function(e,t){var a=0;return $(t.element).map(function(e,t){$(t).prop("checked")||a++}),0<a}},checkbox:{name:"checkbox",library:"JQuery-UI",description:"a single binary option",default_val:!1,getValue:function(e,t){return $(t.element).prop("checked")},isActive:function(e,t){return $(t.element).prop("checked")!=t.type.default_val}}},this.filter_items={daterange:{element:"#filter-daterange-input",type:this.filter_types.date_range_controller,name:["start_date","end_date"]},month:{element:"#filter-month-input",type:this.filter_types.select,name:"month[]"},dayofweek:{element:"#filter-dayofweek-input-mon, #filter-dayofweek-input-tues, #filter-dayofweek-input-wed, #filter-dayofweek-input-thur, #filter-dayofweek-input-fri, #filter-dayofweek-input-sat, #filter-dayofweek-input-sun",type:this.filter_types.checkbox_group,name:"dayofweek"},yeartodate:{element:"#filter-yeartodate-input",type:this.filter_types.checkbox,name:"yeartodate"},season:{element:"#filter-season-input",type:this.filter_types.select,name:"season[]"},season_status:{element:"#filter-seasonStatusOn-input, #filter-seasonStatusOff-input",type:this.filter_types.checkbox_group,name:"season_status"},team:{element:"#filter-team-input",type:this.filter_types.select,name:"team[]"},conference:{element:"#filter-conference-AFC-input, #filter-conference-NFC-input",type:this.filter_types.checkbox_group,name:"conference"},division:{element:"#filter-division-input",type:this.filter_types.select,name:"division[]"},crimeCategory:{element:"#filter-crime-category-input",type:this.filter_types.select,name:"crimeCategory[]"},crime:{element:"#filter-crime-input",type:this.filter_types.select,name:"crime[]"},position:{element:"#filter-position-input",type:this.filter_types.select,name:"position[]"},position_type:{element:"#filter-position-type-input-o, #filter-position-type-input-d, #filter-position-type-input-s",type:this.filter_types.checkbox_group,name:"position_type"},player:{element:"#filter-player-input",type:this.filter_types.select,name:"player[]"}},this.filter_sections={date:{title:"Date Filters",element:"#filter-date-section",items:[this.filter_items.daterange,this.filter_items.month,this.filter_items.dayofweek,this.filter_items.yeartodate]},season:{title:"Season Filters",element:"#filter-season-section",items:[this.filter_items.season,this.filter_items.season_status]},team:{title:"Team Filters",element:"#filter-team-section",items:[this.filter_items.team,this.filter_items.conference,this.filter_items.division]},crime:{title:"Crime Filters",element:"#filter-crime-section",items:[this.filter_items.crimeCategory,this.filter_items.crime]},position:{title:"Position Filters",element:"#filter-position-section",items:[this.filter_items.position,this.filter_items.position_type]},player:{title:"Player Filters",element:"#filter-player-section",items:[this.filter_items.player]}}}}class FiltersControl{constructor(e){this.options=e||{},this.options.hidden_panels=e.hidden_panels||[],this.options.presets=e.presets||{},this.options.date_range_object=e.date_range_object||{},this.options.dialog_element_container=e.dialog_element_container||"#filter-dialog-container",this.options.dialog_element=e.dialog_element||"#filter-dialog",this.options.dialog_content_url=e.dialog_content_url||"templates/FiltersTemplateCache.html",this.filters_model=new FiltersModel,this.dateRangeNFL=this.options.date_range_object,this.first_open=!0;var t=this;$("#filters-open-button").click(function(){t.show()}),$("#filter-dialog-container").click(function(e){"filter-dialog-container"==e.target.id&&t.hide()}),this.hide()}on(e,t){e&t&&$(self.options.dialog_element).on(e,t)}show(){$(this.options.dialog_element_container).show(),this.first_open&&(this.loadDialogContents(),this.first_open=!1)}hide(){$(this.options.dialog_element_container).hide()}loadDialogContents(){var e=this;loadCSS("css/modules/styles-filters.css"),loadCSS("css/vendor/chosen.min.css"),$(e.options.dialog_element_container).load(e.options.dialog_content_url,function(){console.log("Load was performed."),e.setupView(),e.renderView()})}setupFilterPresets(){for(var e in this.options.presets){var t,a=this.options.presets[e];for(t in a){a[t];switch(t){case"team":case"crime":case"position":case"player":this.options.hidden_panels.push(t);break;default:console.log("unknown preset")}}}}setupFilterInput(e){$(".filter-chosen-multi").chosen({inherit_select_classes:!0,hide_results_on_select:!1}).change(e),$(".filter-radio-group input").checkboxradio({icon:!1}).change(e),$("#dateRangeJquery").on("dateRangeChanged",e),$(".filter-type-btn").click(function(){$(this).removeClass("filter-include filter-exclude"),"Exclude"===$(this).html()?($(this).html("Include"),$(this).addClass("filter-include")):($(this).html("Exclude"),$(this).addClass("filter-exclude"))})}setupUserInterface(){var e=this;$(".filter-section-title").click(function(){$(this).parent().children().eq(1).toggle()}),$("#filters-close-button").click(function(){$(e.options.dialog_element).trigger("FilterDialogClosed"),e.hide()}),$("#filters-apply-button").click(function(){e.apply(),console.log(e.options.dialog_element),$(e.options.dialog_element).trigger("FilterDialogChanged"),$(window).trigger("hashchange"),e.hide()}),$("#filters-clear-button").click(function(){e.reset(),$(e.options.dialog_element).trigger("FilterDialogReset")}),$("#filters-cancel-button").click(function(){e.hide()})}apply(){var e,t=this.getFilterValues();for(e in t)for(var a in t[e])setCookieValue(a,t[e][a])}reset(){for(var e in this.filters_model.filter_sections)if(this.filters_model.filter_sections.hasOwnProperty(e)){var t,a=this.filters_model.filter_sections[e].items;for(t in a)if(a.hasOwnProperty(t)){var n=a[t];if(Array.isArray(n.type.default_val)&&n.type.hasOwnProperty("names")){var i,r=0;for(i in n.type.default_val)setCookieValue(n.type.names[r],n.type.default_val[r++])}else setCookieValue(t,n.type.default_val)}}this.loadDialogContents()}onFilterChanged(e,t,a){var n=t.currentTarget.getAttribute("id"),i=n.substring(n.indexOf("-")+1,n.length),t=i.substring(0,i.lastIndexOf("-"));console.log(n,i,t),e.renderView()}setupView(){var a=this;this.setupFilterPresets(),this.setupUserInterface(),this.setupFilterInput(function(e,t){a.onFilterChanged(a,e,t)})}renderView(){var e,t=this;for(e in this.countActiveFilters(),t.options.hidden_panels)switch(t.options.hidden_panels[e]){case"team":case"crime":case"position":case"player":$(t.filters_model.filter_sections[t.options.hidden_panels[e]].element).hide()}$("#filter-daterange-input").html(t.dateRangeNFL.getStart()+"-"+t.dateRangeNFL.getEnd()),$("#filter-date-section .filter-section-title span").html(this.filters_model.filter_sections.date.active_count+"/4"),$("#filter-season-section .filter-section-title span").html(this.filters_model.filter_sections.season.active_count+"/2"),$("#filter-team-section .filter-section-title span").html(this.filters_model.filter_sections.team.active_count+"/3"),$("#filter-crime-section .filter-section-title span").html(this.filters_model.filter_sections.crime.active_count+"/2"),$("#filter-position-section .filter-section-title span").html(this.filters_model.filter_sections.position.active_count+"/2"),$("#filter-player-section .filter-section-title span").html(this.filters_model.filter_sections.player.active_count+"/1")}countActiveFilters(){for(var e in this.filters_model.filter_sections)if(this.filters_model.filter_sections.hasOwnProperty(e)){var t,a,n,i=this.filters_model.filter_sections[e];for(t in i.active_count=0,i.items)i.items.hasOwnProperty(t)&&(n=(a=i.items[t]).type.isActive(this,a),(a.active=n)&&i.active_count++)}}getFilterValues(){var e,t={};for(e in this.filters_model.filter_sections)if(this.filters_model.filter_sections.hasOwnProperty(e)){var a,n=this.filters_model.filter_sections[e].items;for(a in n)if(n.hasOwnProperty(a)){var i=n[a],r=i.name,o=i.type.getValue(this,i);if(i.active)if(t.hasOwnProperty(e)||(t[e]={}),Array.isArray(o)&&i.type.hasOwnProperty("names")){var s,l=0;for(s in o)t[e][i.type.names[l++]]=o[s]}else t[e][r]=o}}return t}getQueryString(){var e,t=this.getFilterValues(),a=[];for(e in t=Object.assign(t,this.options.presets))for(var n in t[e])if(Array.isArray(t[e][n]))for(var i in t[e][n])a.push(n+"="+t[e][n][i]);else a.push(n+"="+t[e][n]);return a.join("&")}}class DonutChart{constructor(e){this.chart=void 0,this.options={targetElement:"#theElementSelector",chartTitle:"default",data:{}},$.extend(!0,this.options,e),this.options.$targetElement=$(this.options.targetElement),this.renderChart()}renderChart(){this.chart=c3.generate({bindto:this.options.targetElement,data:{columns:this.options.data,type:"donut"},donut:{title:this.options.chartTitle},color:{pattern:["#1F77B4","#FF7F0E","#2CA02C","#D62728","#9467BD","#8C564B","#E377C2","#7F7F7F","#BCBD22","#17BECF","#154F78","#B0580A","#248224","#7D1717"]}})}}var lastUpdate="12/21/2021, 12:04:31 AM";class ArrestCard{constructor(e,t){if(this.row=e,this.options=t||{showName:!1,momentDate:!1,standalone:!1},this.Column_Team={column:"Team",color:"Team_hex_color",url:"Team.html",display:"Team_preffered_name",color2:"Team_hex_alt_color",useColor2:!0},this.Column_Crime={column:"Category",color:"Crime_category_color",url:"Crime.html",display:"Category"},this.Column_Player={column:"Name",color:"Team_hex_color",url:"Player.html",display:"Name",color2:"Team_hex_alt_color",useColor2:!0},this.Column_Position={column:"Position",color:"Team_hex_color",url:"Position.html",display:"Position",color2:"Team_hex_alt_color",useColor2:!0},!this.row.hasOwnProperty("Team_preffered_name"))throw"error: incorrect row definition"}getHTML(e,t){var e=e||{column:"Category",color:"Crime_category_color",url:"Crime.html",display:"Category"},t=t||{column:"Team",color:"Team_hex_color",url:"Team.html",display:"Team_preffered_name",color2:"Team_hex_alt_color",useColor2:!0},a=this.options.showName?' style="display:inline-block; visibility:visible;"':"",n=this.options.momentDate?moment(row.Date,"YYYY-MM-DD").fromNow():this.row.DaysSince+" days ago",i=['<div class="card arrest_card '+(this.options.standalone?" standalone_card":"")+'">'];return i.push('<span class="date_item" title="'+this.row.Date+'">'+n+"</span>"),i.push('<span class="name_item"'+a+'><a href="Player.html#'+this.row.Name+'">'+this.row.Name+"</a> </span>"),i.push("<br />"),i.push('<span class="crime_item" style="background-color:#'+this.row[e.color]+'">'),i.push('<a href="'+e.url+"#"+this.row[e.column]+'">'+this.row[e.display]+"</a> </span>"),i.push('<span class="team_item '+this.row[t.column]+'" style="background-color:#'+this.row[t.color]+';">'),i.push('<a href="'+t.url+"#"+this.row[t.column]+'" '+(t.useColor2?'style="color:#'+this.row[t.color2]+';"':"")+" >"+this.row[t.display]+"</a></span>"),i.push("<br />"),i.push('<span class="description_item">'+this.row.Description+"</span>"),i.push('<span class="outcome_item">'+this.row.Outcome+"</span>"),i.push("</div>"),i.join("")}}var meter_use_current_day=!0,DataController={options:{dateRange:void 0,data:void 0},init:function(e,t){DataController.options.date_range=e,DataController.options.data=ArrestsCacheTable;function a(e,t){return e=Date.UTC(e.getFullYear(),e.getMonth(),e.getDate()),t=Date.UTC(t.getFullYear(),t.getMonth(),t.getDate()),Math.floor((t-e)/864e5)}DataController.forEach(function(e,t){meter_use_current_day&&(DataController.options.data[t].daysSince=a(new Date(e.Date),new Date),e.daysSince=a(new Date(e.Date),new Date))}),DataController.options.data.sort(function(e,t){return e.daysSince<t.daysSince?1:e.daysSince>t.daysSince?-1:0}),t(this)},forEach:function(e,t,a){t=t||function(){},a=a||!0;for(var n=DataController.options.data.length-1;0<=n;n--){var i=DataController.options.data[n];(!a||this.dateLimit(i,DataController.options.date_range.getStart(),DataController.options.date_range.getEnd()))&&e(i,n)}t()},incrementMap:function(e,t){return e.hasOwnProperty(t)?e[t]=e[t]+1:e[t]=1,e},dateLimit:function(e,t,a){return new Date(e.Date)>=new Date(t)&&new Date(e.Date)<=new Date(a)},getActivePlayerArrests:function(e){e(["no data"])},getMostRecentArrest:function(e){var t,a=DataController,n=999999999;a.forEach(function(e){a.dateLimit(e,DataController.options.date_range.getStart(),DataController.options.date_range.getEnd())&&e.daysSince<n&&(n=(t=e).daysSince)},function(){e(t)})},getTeams:function(e){for(var t=[],a=[],n=new Map,i=DataController.options.data.length-1;0<=i;i--){var r=DataController.options.data[i];t.push({Team:r.Team,Team_preffered_name:r.Team_preffered_name,Team_logo_id:r.Team_logo_id})}for(i=t.length-1;0<=i;i--){var o=t[i];n.has(o.Team)||(n.set(o.Team,!0),a.push(o))}e(a)},getArrestMeter:function(e){var a=0,n=-1,i=0,r=9e9;DataController.forEach(function(e,t){i++,a+=e.DaysToLastArrest,e.DaysToLastArrest>n&&(n=e.DaysToLastArrest),e.DaysSince<r&&(r=e.DaysSince)}),a/=i,e({alltime:{record:Math.floor(n),average:Math.floor(a),raw_average:Math.floor(a)},current:{daysSince:Math.floor(r),probability:Math.exp(-1*r)/a,odds:Math.floor(1/Math.exp(-1*r/a))}})},getDonutChart:function(a,e,t){for(var n={},i=[],r=DataController.options.data.length-1;0<=r;r--){var o=DataController.options.data[r];e(o)&&this.dateLimit(o,DataController.options.date_range.getStart(),DataController.options.date_range.getEnd())&&(n=this.incrementMap(n,o[a]))}Object.keys(n).forEach(function(e){var t={};t[a]=e,t.arrest_count=n[e],i.push(t)}),t(i.sort(function(e,t){return t.arrest_count-e.arrest_count}))},getOverallChart:function(e,t,a,n,i){for(var r={Year:"Year",Month:"Month",Day:"Day_of_Week",DayOrder:"Day_of_Week_int",Team:"Team_preffered_name","Team Code":"Team",Conference:"Team_Conference",Division:"Team_Conference_Division",Position:"Position",Crime:"Crime_category",Season:"Season",SeasonState:"ArrestSeasonState",Measure:"arrest_count"},o=r[t],s=r[e],a=r[a],n=n,l={},c={},d={},p=DataController.options.data.length-1;0<=p;p--){var m=DataController.options.data[p];this.dateLimit(m,DataController.options.date_range.getStart(),DataController.options.date_range.getEnd())&&(l=this.incrementMap(l,m[o]+m[s]),c=this.incrementMap(c,m[o]),d=this.incrementMap(d,m[s]))}var h=[];Object.keys(c).forEach(function(e){h.push({bar:e,arrest_count:c[e]})}),"DESC"==n&&a==o&&h.sort(function(e,t){return t.arrest_count-e.arrest_count});var u=[];Object.keys(d).forEach(function(e){u.push(e)});var g=["x"];h.forEach(function(e){g.push(e.bar)});var f=[];f.push(g),Object.keys(d).forEach(function(t){var a=[t];h.forEach(function(e){e=e.bar,e=l[e+t];a.push(e=null==e?0:e)}),f.push(a)}),i({columns:f,groups:u})},getTopLists:function(e,t,a,n){for(var i=[],r={},o={},s={},l=[],c=[],d=[],p=DataController.options.data.length-1;0<=p;p--){var m=DataController.options.data[p];this.dateLimit(m,DataController.options.date_range.getStart(),DataController.options.date_range.getEnd())&&(r=this.incrementMap(r,m.Category),o=this.incrementMap(o,m.Name),s=this.incrementMap(s,m.Position))}Object.keys(r).forEach(function(e){var t={};t.Category=e,t.arrest_count=r[e],l.push(t)}),Object.keys(o).forEach(function(e){var t={};t.Name=e,t.arrest_count=o[e],c.push(t)}),Object.keys(s).forEach(function(e){var t={};t.Position=e,t.arrest_count=s[e],d.push(t)});function h(e,t){return t.arrest_count-e.arrest_count}i.push(l.sort(h).slice(e,e+5)),i.push(c.sort(h).slice(e,e+5)),i.push(d.sort(h).slice(e,e+5)),n(i)},getArrests:function(t,e){var a=[],n=this;n.forEach(function(e){n.dateLimit(e,DataController.options.date_range.getStart(),DataController.options.date_range.getEnd())&&t(e)&&a.push(e)},function(){e(a)})}};function setCookieValue(e,t,a){var n=new Date;a=a||.5,n.setTime(n.getTime()+24*a*60*60*1e3);n="expires="+n.toUTCString();document.cookie=e+"="+t+"; "+n}function getCookieValue(e){for(var t=e+"=",a=document.cookie.split(";"),n=0;n<a.length;n++){for(var i=a[n];" "==i.charAt(0);)i=i.substring(1);if(0==i.indexOf(t))return i.substring(t.length,i.length)}return""}function gaEvent(e,t,a,n,i){googleTracking.sendTrackEvent(a,n)}function setupFacebook(){var e,t,a;console.log("FB Setup"),window.fbAsyncInit=function(){FB.init({appId:"563956043742586",xfbml:!0,version:"v2.4"}),FB.Event.subscribe("edge.create",function(e){gaEvent("send","social","facebook","like",e)}),FB.Event.subscribe("edge.remove",function(e){gaEvent("send","social","facebook","unlike",e)}),FB.Event.subscribe("message.send",function(e){gaEvent("send","social","facebook","send",e)})},e=document,t="facebook-jssdk",a=e.getElementsByTagName("script")[0],e.getElementById(t)||((e=e.createElement("script")).id=t,e.src="//connect.facebook.net/en_US/sdk.js",a.parentNode.insertBefore(e,a))}function setupTwitter(){var e,t,a,n;console.log("twitter setup"),window.twttr=(e=document,t="twitter-wjs",a=e.getElementsByTagName("script")[0],n=window.twttr||{},e.getElementById(t)||((e=e.createElement("script")).id=t,e.src="https://platform.twitter.com/widgets.js",a.parentNode.insertBefore(e,a),n._e=[],n.ready=function(e){n._e.push(e)}),n),twttr.ready(function(e){e.events.bind("tweet",function(e){var t;e&&(t=window.location.href,gaEvent("send","social","twitter","tweet",t=e.target&&"IFRAME"==e.target.nodeName?extractParamFromUri(e.target.src,"url"):t),console.log("thanks for sharing",t))})})}function update_hash(){var e=window.location.pathname.split("/");return pageID=window.location.hash||extractParamFromUri(window.location.search,"id")||e.pop()||e.pop()||"#!ID Not Set",pageID=decodeURI(pageID),pageID=pageID.replace("#!",""),pageID=pageID.replace("#",""),$("#pageTitle").append(pageID),pageID}function extractParamFromUri(e,t){if(!e)return null;e=new RegExp("[\\?&#]"+t+"=([^&#]*)").exec(e);return null!=e?decodeURI(unescape(e[1])):null}function saveCanvasAsPNG(e){e=document.getElementById(e).toDataURL("image/png").replace("image/png","image/octet-stream");window.location.href=e}window.mobileCheck=function(){var e,t=!1;return e=navigator.userAgent||navigator.vendor||window.opera,t=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))?!0:t};var timeSeriesChart={timeChart:void 0,options:{targetElement:"#theElementSelector",compareToBtn:"#btnSelector",initColumnID:"",data:{},isExpanded:!(window.mobileAndTabletCheck=function(){var e,t=!1;return e=navigator.userAgent||navigator.vendor||window.opera,t=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))?!0:t}),showAccumulation:!1,ajaxURL:"/api/"},init:function(e){$.extend(!0,this.options,e);var t=this;console.log("Initialize Chart:  "+this.options.targetElement),t.options.$targetElement=$(this.options.targetElement),t.options.$expandBtnElement=$(this.options.targetExpandBtn),timeSeriesChart.options.$expandBtnElement.off("click"),timeSeriesChart.options.$expandBtnElement.click(function(){t.toggleExpand(t)}),t.renderChart()},renderChart:function(){var e;e=$(document).width()<800?20:6,timeSeriesChart.timeChart=c3.generate({bindto:timeSeriesChart.options.targetElement,data:{x:"x",columns:[timeSeriesChart.getXDates(),timeSeriesChart.fillDates(timeSeriesChart.options.initColumnID,timeSeriesChart.options.data)]},axis:{x:{type:"timeseries",tick:{format:"%m/%y"}}},padding:{bottom:e},color:{pattern:["#1F77B4","#FF7F0E","#2CA02C","#D62728","#9467BD","#8C564B","#E377C2","#7F7F7F","#BCBD22","#17BECF","#154F78","#B0580A","#248224","#7D1717"]}})},buildAjaxURL:function(e,t){t=t||{};var a,n,i={id:e,start_date:dateRangeController.getStart(),end_date:dateRangeController.getEnd()};for(n in $.extend(i,t),a=timeSeriesChart.options.ajaxURL.indexOf("?")<0?"?":"&",i)a+=n+"="+i[n]+"&";return a=a.substring(0,a.length-1),timeSeriesChart.options.ajaxURL+a},addColumn:function(t){googleTracking.sendTrackEvent("TimeChart","addCompare "+t);var e=timeSeriesChart.buildAjaxURL(t);$.getJSON(e,function(e){e=timeSeriesChart.fillDates(t,e);e[0];timeSeriesChart.timeChart.load({columns:[e]})})},fillDates:function(e,t){e=e||"",t=(t=t||[]).reverse();for(var a,n=new Date(dateRangeController.getStart()),i=new Date(dateRangeController.getEnd()),i=12*(i.getFullYear()-n.getFullYear())+(i.getMonth()-n.getMonth())+1,r=n.getFullYear(),o=n.getMonth()+1,s=[e.toString()],l=0,c=t.pop(),d=i;0<d;d--)void 0!==c?(12<++o&&(r++,o%=12),c.Year==r.toString()&&c.Month==o.toString()?(a=timeSeriesChart.options.showAccumulation?l+=parseInt(c.arrest_count):parseInt(c.arrest_count),s.push(a),0<t.length&&(c=t.pop())):(a=timeSeriesChart.options.showAccumulation?l:0,s.push(a))):s.push(0);return s},getXDates:function(){for(var e=["x"],t=new Date(dateRangeController.getStart()),a=new Date(dateRangeController.getEnd()),a=12*(a.getFullYear()-t.getFullYear())+(a.getMonth()-t.getMonth())+1,n=t.getFullYear(),i=t.getMonth()+1,r=a-1;0<r;r--)12<++i&&(n++,i%=12),e.push(n+"-"+(i<10?"0"+i:i)+"-01");return e},toggleExpand:function(e){timeSeriesChart.options.$targetElement.toggleClass("expanded"),timeSeriesChart.options.isExpanded=!timeSeriesChart.options.isExpanded,timeSeriesChart.options.isExpanded?timeSeriesChart.options.$expandBtnElement.html("Collapse"):timeSeriesChart.options.$expandBtnElement.html("Expand"),googleTracking.sendTrackEvent("mainChart","expand toggle"),timeSeriesChart.renderChart()}},dateRangeController={start_date:"2000-01-01",end_date:"",init:function(e){$("#dateRangeJquery").daterangepicker({presetRanges:[{text:"Last 3 Months",dateStart:function(){return moment().subtract("months",3)},dateEnd:function(){return moment()}},{text:"Last 6 Months",dateStart:function(){return moment().subtract("months",6)},dateEnd:function(){return moment()}},{text:"Last Year",dateStart:function(){return moment().subtract("years",1)},dateEnd:function(){return moment()}},{text:"Last 5 Years",dateStart:function(){return moment().subtract("years",5)},dateEnd:function(){return moment()}},{text:"All Records",dateStart:function(){return moment("2000-01-01")},dateEnd:function(){return moment()}}],datepickerOptions:{minDate:new Date("2000-01-01"),maxDate:0}});var t=moment().format("YYYY-MM-DD");this.start_date=this.getCookie("start_date")||"2000-01-01",this.end_date=this.getCookie("end_date")||t,$("#dateRangeJquery").daterangepicker("setRange",{start:moment(this.start_date).toDate(),end:moment(this.end_date).toDate()}),$("#dateRangeJquery").on("change",this.changeDateRange),$("#dateRangeJquery").on("open",function(){googleTracking.sendTrackEvent("DateRange","OpenDialog")}),e(this)},open:function(){$("#dateRangeJquery").daterangepicker("open")},close:function(){$("#dateRangeJquery").daterangepicker("close")},resetTime:function(e){googleTracking.sendTrackEvent("DateRange","Reset");var t=dateRangeController.getToday();dateRangeController.setDates("2000-01-01",t)},getToday:function(){var e=new Date,t=e.getMonth()<9?"0"+(e.getMonth()+1):e.getMonth()+1,a=e.getDate()<10?"0"+e.getDate():e.getDate();return e.getFullYear()+"-"+t+"-"+a},getStart:function(){return this.start_date},getEnd:function(){return this.end_date},changeDateRange:function(){var e=JSON.parse($("#dateRangeJquery").val());console.log(e);var t=e.start,a=e.end;new Date(t)>new Date(a)&&(e=t,t=a,a=e),dateRangeController.setDates(t,a)},setDates:function(e,t){dateRangeController.setCookie("start_date",e),dateRangeController.setCookie("end_date",t),dateRangeController.start_date=e,dateRangeController.end_date=t,window.CustomEvent&&(new Event("dateRangeChanged"),$("#dateRangeJquery").trigger("dateRangeChanged"),googleTracking.sendTrackEvent("DateRange","DateChanged"))},setCookie:function(e,t,a){return setCookieValue(e,t,a)},getCookie:function(e){return getCookieValue(e)}},hashervar=window.location.hash||"",pagePath=window.location.pathname+hashervar,googleTracking={tracker:void 0,initialize:function(e){googleTracking.tracker=e},sendTrackEvent:function(e,t){arguments.length<3&&ga("send","event",e,t)}};!function(e,t,a,n,i){e.GoogleAnalyticsObject=a,e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=+new Date,n=t.createElement("script"),i=t.getElementsByTagName("script")[0],n.async=1,n.src="//www.google-analytics.com/analytics.js",i.parentNode.insertBefore(n,i)}(window,document,"ga"),ga("create","UA-66360026-1","auto"),ga("send","pageview",pagePath),googleTracking.initialize(ga),$(document).ready(function(){$(".donate").click(function(){googleTracking.sendTrackEvent("Donate","Click")})});class StyleSheetManager{constructor(){this.stylesheets=["css/styles.min.css","css/vendor/normalize.min.css","css/vendor/skeleton.min.css","css/vendor/c3.css","css/vendor/jquery-ui.min.css","css/vendor/jquery.comiseo.daterangepicker.css"],this.loadStylesheets()}loadCSS(e){var t,a;return t=document,a=t.createElement("LINK"),t=t.getElementsByTagName("LINK")[0],a.href=e,a.rel="stylesheet",t.parentNode.insertBefore(a,t),!0}loadStylesheets(e){for(var t=e||this.stylesheets||[],a=!0,n=0;n<t.length;n++)a=this.loadCSS(t[n]),DEBUG&&console.log(t[n]+" Loaded");return a}}var StyleSheetManagerInstance=new StyleSheetManager;function loadCSS(e){DEBUG&&console.warn("Deprecated loadCSS("+e+") function called!"),StyleSheetManagerInstance.loadCSS(e)}